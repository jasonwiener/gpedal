(function(e){function t(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var a={};return t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(a,'a',a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=50)})([function(e,t,a){'use strict';function n(e,t){this._groups=e,this._parents=t}function i(){return new n([[document.documentElement]],j)}a.d(t,'b',function(){return j}),t.a=n;var r=a(58),o=a(59),l=a(61),s=a(63),d=a(18),c=a(65),p=a(66),g=a(67),u=a(68),m=a(69),h=a(70),y=a(71),f=a(72),v=a(73),b=a(74),_=a(75),S=a(76),w=a(77),k=a(78),x=a(79),I=a(80),E=a(81),T=a(82),L=a(83),C=a(84),M=a(85),A=a(86),B=a(87),N=a(88),j=[null];n.prototype=i.prototype={constructor:n,select:r.a,selectAll:o.a,filter:l.a,data:s.a,enter:d.b,exit:c.a,merge:p.a,order:g.a,sort:u.a,call:m.a,nodes:h.a,node:y.a,size:f.a,empty:v.a,each:b.a,attr:_.a,style:S.a,property:w.a,classed:k.a,text:x.a,html:I.a,raise:E.a,lower:T.a,append:L.a,insert:C.a,remove:M.a,datum:A.a,on:B.a,dispatch:N.a}},function(e,t){'use strict';t.a=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}},function(e,t,a){'use strict';var n=a(12);a.d(t,'a',function(){return n.e}),a.d(t,'f',function(){return n.g}),a.d(t,'d',function(){return n.f});var i=a(106);a.d(t,'e',function(){return i.a}),a.d(t,'c',function(){return i.b});var r=a(107);a.d(t,'b',function(){return r.a})},function(e,t){'use strict';t.a=function(e){return null===e?NaN:+e}},function(e,t,a){'use strict';function n(e,a){return function(n){return e+n*a}}function i(e,a,n){return e=o(e,n),a=o(a,n)-e,n=1/n,function(i){return o(e+i*a,n)}}function r(e,t){var a=t-e;return a?n(e,a):Object(l.a)(isNaN(e)?t:e)}var o=Math.pow;t.c=function(e,t){var a=t-e;return a?n(e,180<a||-180>a?a-360*Math.round(a/360):a):Object(l.a)(isNaN(e)?t:e)},t.b=function(e){return 1==(e=+e)?r:function(t,a){return a-t?i(t,a,e):Object(l.a)(isNaN(t)?a:t)}},t.a=r;var l=a(39)},function(e,t){'use strict';t.a=function(e,n){return e=+e,n-=e,function(a){return e+n*a}}},function(e,t,a){'use strict';var n=a(15);t.a=function(e){return e=Object(n.a)(Math.abs(e)),e?e[1]:NaN}},function(e,t){'use strict';t.d=function(e){return new Promise((t)=>setTimeout(t,e))},t.b=function(e){return new Promise(function(t,a){let n=new FileReader;n.onload=(a)=>{t(a.target.result)},n.onerror=(t)=>{a(t.target.error)},n.readAsText(e,'UTF-8')})},t.c=function(e){return new Promise(function(t){let a=!1,n=(i)=>{e.removeEventListener('characteristicvaluechanged',n),e.stopNotifications(),a||(a=!0,t(i.target.value))};e.addEventListener('characteristicvaluechanged',n),e.startNotifications()})},t.a=function(e){let t=e.getUTCMonth()+1;t=10>t?'0'+t:t;let a=e.getUTCDate();a=10>a?'0'+a:a;let n=e.getUTCHours();n=10>n?'0'+n:n;let i=e.getUTCMinutes();i=10>i?'0'+i:i;let r=e.getUTCSeconds();return r=10>r?'0'+r:r,e.getUTCFullYear()+'-'+t+'-'+a+'T'+n+':'+i+':'+r+'Z'}},function(e,t,a){'use strict';var n=a(24);a.d(t,'a',function(){return n.a});var i=a(1),r=a(25),o=a(90),l=a(91),s=a(27),d=a(9),c=a(92),p=a(95),g=a(96),u=a(32),m=a(97),h=a(98),y=a(99),f=a(100),v=a(33),b=a(26),_=a(101),S=a(10),w=a(30),k=a(102),x=a(103),I=a(104),E=a(31);a.d(t,'d',function(){return E.a}),a.d(t,'b',function(){return E.b}),a.d(t,'c',function(){return E.c});var T=a(34),L=a(28),C=a(105)},function(e,t){'use strict';t.a=function(e,t){var a,r,o,l=e.length,n=-1;if(null==t){for(;++n<l;)if(null!=(a=e[n])&&a>=a)for(r=o=a;++n<l;)null!=(a=e[n])&&(r>a&&(r=a),o<a&&(o=a));}else for(;++n<l;)if(null!=(a=t(e[n],n,e))&&a>=a)for(r=o=a;++n<l;)null!=(a=t(e[n],n,e))&&(r>a&&(r=a),o<a&&(o=a));return[r,o]}},function(e,t,a){'use strict';var r=a(3);t.a=function(e,t,a){if(null==a&&(a=r.a),!!(o=e.length)){if(0>=(t=+t)||2>o)return+a(e[0],0,e);if(1<=t)return+a(e[o-1],o-1,e);var o,n=(o-1)*t,i=Math.floor(n),l=+a(e[i],i,e),s=+a(e[i+1],i+1,e);return l+(s-l)*(n-i)}}},function(e,t,a){'use strict';var n=a(2),i=a(37),r=a(40),o=a(41),l=a(5),s=a(42),d=a(43),p=a(39);t.a=function(e,a){var g,c=typeof a;return null==a||'boolean'==c?Object(p.a)(a):('number'==c?l.a:'string'==c?(g=Object(n.a)(a))?(a=g,i.a):d.a:a instanceof n.a?i.a:a instanceof Date?o.a:Array.isArray(a)?r.a:'function'!=typeof a.valueOf&&'function'!=typeof a.toString||isNaN(a)?s.a:l.a)(e,a)}},function(e,t,a){'use strict';function n(){}function i(e){var t;return e=(e+'').trim().toLowerCase(),(t=w.exec(e))?(t=parseInt(t[1],16),new d(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=k.exec(e))?r(parseInt(t[1],16)):(t=x.exec(e))?new d(t[1],t[2],t[3],1):(t=I.exec(e))?new d(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=E.exec(e))?o(t[1],t[2],t[3],t[4]):(t=T.exec(e))?o(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=L.exec(e))?c(t[1],t[2]/100,t[3]/100,1):(t=C.exec(e))?c(t[1],t[2]/100,t[3]/100,t[4]):M.hasOwnProperty(e)?r(M[e]):'transparent'===e?new d(NaN,NaN,NaN,0):null}function r(e){return new d(255&e>>16,255&e>>8,255&e,1)}function o(e,t,n,i){return 0>=i&&(e=t=n=NaN),new d(e,t,n,i)}function l(e){return(e instanceof n||(e=i(e)),!e)?new d:(e=e.rgb(),new d(e.r,e.g,e.b,e.opacity))}function s(e,t,a,n){return 1===arguments.length?l(e):new d(e,t,a,null==n?1:n)}function d(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function c(e,t,n,i){return 0>=i?e=t=n=NaN:0>=n||1<=n?e=t=NaN:0>=t&&(e=NaN),new u(e,t,n,i)}function p(e){if(e instanceof u)return new u(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=i(e)),!e)return new u;if(e instanceof u)return e;e=e.rgb();var t=e.r/255,a=e.g/255,r=e.b/255,d=f(t,a,r),c=y(t,a,r),p=NaN,g=c-d,s=(c+d)/2;return g?(p=t===c?(a-r)/g+6*(a<r):a===c?(r-t)/g+2:(t-a)/g+4,g/=0.5>s?c+d:2-c-d,p*=60):g=0<s&&1>s?0:p,new u(p,g,s,e.opacity)}function g(e,t,a,n){return 1===arguments.length?p(e):new u(e,t,a,null==n?1:n)}function u(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function m(e,t,a){return 255*(60>e?t+(a-t)*e/60:180>e?a:240>e?t+(a-t)*(240-e)/60:t)}var y=Math.max,f=Math.min,h=Math.round,v=Math.pow;t.a=n,a.d(t,'d',function(){return _}),a.d(t,'c',function(){return S}),t.e=i,t.h=l,t.g=s,t.b=d,t.f=g;var b=a(13),_=0.7,S=1/_,w=/^#([0-9a-f]{3})$/,k=/^#([0-9a-f]{6})$/,x=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,I=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,E=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,T=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,L=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,C=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,M={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object(b.a)(n,i,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+''}}),Object(b.a)(d,s,Object(b.b)(n,{brighter:function(e){return e=null==e?S:v(S,e),new d(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?_:v(_,e),new d(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},toString:function(){var e=this.opacity;return e=isNaN(e)?1:y(0,f(1,e)),(1===e?'rgb(':'rgba(')+y(0,f(255,h(this.r)||0))+', '+y(0,f(255,h(this.g)||0))+', '+y(0,f(255,h(this.b)||0))+(1===e?')':', '+e+')')}})),Object(b.a)(u,g,Object(b.b)(n,{brighter:function(e){return e=null==e?S:v(S,e),new u(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?_:v(_,e),new u(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(0.5>a?a:1-a)*t,i=2*a-n;return new d(m(240<=e?e-240:e+120,i,n),m(e,i,n),m(120>e?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}))},function(e,t){'use strict';t.b=function(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a},t.a=function(e,t,a){e.prototype=t.prototype=a,a.constructor=e}},function(e,t){'use strict';function a(e,t,a,n,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*a+(1+3*e+3*r-3*o)*n+o*i)/6}t.a=a,t.b=function(e){var r=e.length-1;return function(n){var t=0>=n?n=0:1<=n?(n=1,r-1):Math.floor(n*r),i=e[t],o=e[t+1],l=0<t?e[t-1]:2*i-o,s=t<r-1?e[t+2]:2*o-i;return a((n-t/r)*r,l,i,o,s)}}},function(e,t){'use strict';t.a=function(e,t){if(0>(a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf('e')))return null;var a,n=e.slice(0,a);return[1<n.length?n[0]+n.slice(2):n,+e.slice(a+1)]}},function(e,t){'use strict';t.a=function(e){return new Promise(function(t,a){i.geocode({location:e},function(e,n){'OK'===n?t(e):a(new Error(n))})})},t.c=function(e,t){return new Promise(function(a,i){n.getPanorama({location:e,radius:t},(e,t)=>{t==google.maps.StreetViewStatus.OK?a(e):i(new Error(t))})})},t.b=function(e){return new Promise(function(t,n){a.getElevationAlongPath(e,(e,a)=>{a==google.maps.ElevationStatus.OK?t(e):n(new Error(a))})})};let a=new google.maps.ElevationService,n=new google.maps.StreetViewService,i=new google.maps.Geocoder},function(e,t){'use strict';function a(){}t.a=function(e){return null==e?a:function(){return this.querySelector(e)}}},function(e,t,a){'use strict';function n(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}t.a=n;var i=a(19),r=a(0);t.b=function(){return new r.a(this._enter||this._groups.map(i.a),this._parents)},n.prototype={constructor:n,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}}},function(e,t){'use strict';t.a=function(e){return Array(e.length)}},function(e,t,a){'use strict';var n=a(21);t.a=function(e){var t=e+='',a=t.indexOf(':');return 0<=a&&'xmlns'!==(t=e.slice(0,a))&&(e=e.slice(a+1)),n.a.hasOwnProperty(t)?{space:n.a[t],local:e}:e}},function(e,t,a){'use strict';a.d(t,'b',function(){return n});var n='http://www.w3.org/1999/xhtml';t.a={svg:'http://www.w3.org/2000/svg',xhtml:n,xlink:'http://www.w3.org/1999/xlink',xml:'http://www.w3.org/XML/1998/namespace',xmlns:'http://www.w3.org/2000/xmlns/'}},function(e,t){'use strict';t.a=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}},function(e,t,a){'use strict';function n(e){return function(){var t=this.ownerDocument,a=this.namespaceURI;return a===o.b&&t.documentElement.namespaceURI===o.b?t.createElement(e):t.createElementNS(a,e)}}function i(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var r=a(20),o=a(21);t.a=function(e){var t=Object(r.a)(e);return(t.local?i:n)(t)}},function(e,t,a){'use strict';var n=a(1),i=a(25),r=Object(i.a)(n.a),o=r.right,l=r.left;t.a=o},function(e,t,a){'use strict';function n(e){return function(t,a){return Object(i.a)(e(t),a)}}var i=a(1);t.a=function(e){return 1===e.length&&(e=n(e)),{left:function(t,a,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;0>e(t[r],a)?n=r+1:i=r}return n},right:function(t,a,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;0<e(t[r],a)?i=r:n=r+1}return n}}}},function(e,t){'use strict';function a(e,t){return[e,t]}t.a=a},function(e,t,a){'use strict';var n=a(28);t.a=function(e,t){var a=Object(n.a)(e,t);return a?Math.sqrt(a):a}},function(e,t,a){'use strict';var r=a(3);t.a=function(e,t){var a,o,l=e.length,n=0,s=-1,i=0,d=0;if(null==t)for(;++s<l;)isNaN(a=Object(r.a)(e[s]))||(o=a-i,i+=o/++n,d+=o*(a-i));else for(;++s<l;)isNaN(a=Object(r.a)(t(e[s],s,e)))||(o=a-i,i+=o/++n,d+=o*(a-i));return 1<n?d/(n-1):void 0}},function(e,t,a){'use strict';a.d(t,'b',function(){return i}),a.d(t,'a',function(){return r});var n=Array.prototype,i=n.slice,r=n.map},function(e,t){'use strict';t.a=function(e,t,a){e=+e,t=+t,a=2>(i=arguments.length)?(t=e,e=0,1):3>i?1:+a;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/a)),n=Array(i);++r<i;)n[r]=e+r*a;return n}},function(e,t){'use strict';function a(e,t,a){var r=(t-e)/o(0,a),g=l(i(r)/n),u=r/s(10,g);return 0<=g?(u>=d?10:u>=c?5:u>=p?2:1)*s(10,g):-s(10,-g)/(u>=d?10:u>=c?5:u>=p?2:1)}var n=Math.LN10,i=Math.log,r=Math.ceil,o=Math.max,l=Math.floor,s=Math.pow;t.b=a,t.c=function(e,t,a){var r=Math.abs(t-e)/o(0,a),g=s(10,l(i(r)/n)),u=r/g;return u>=d?g*=10:u>=c?g*=5:u>=p&&(g*=2),t<e?-g:g};var d=7.0710678118654755,c=3.1622776601683795,p=1.4142135623730951;t.a=function(e,t,o){var s,n,d,c=t<e,p=-1;if(c&&(s=e,e=t,t=s),0===(d=a(e,t,o))||!isFinite(d))return[];if(0<d)for(e=r(e/d),t=l(t/d),n=Array(s=r(t-e+1));++p<s;)n[p]=(e+p)*d;else for(e=l(e*d),t=r(t*d),n=Array(s=r(e-t+1));++p<s;)n[p]=(e-p)/d;return c&&n.reverse(),n}},function(e,t){'use strict';t.a=function(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}},function(e,t){'use strict';t.a=function(e,t){var a,r,o=e.length,n=-1;if(null==t){for(;++n<o;)if(null!=(a=e[n])&&a>=a)for(r=a;++n<o;)null!=(a=e[n])&&r>a&&(r=a);}else for(;++n<o;)if(null!=(a=t(e[n],n,e))&&a>=a)for(r=a;++n<o;)null!=(a=t(e[n],n,e))&&r>a&&(r=a);return r}},function(e,t,a){'use strict';function r(e){return e.length}var o=a(33);t.a=function(e){if(!(l=e.length))return[];for(var t=-1,a=Object(o.a)(e,r),i=Array(a);++t<a;)for(var l,n=-1,s=i[t]=Array(l);++n<l;)s[n]=e[n][t];return i}},function(e,t,a){'use strict';var n=a(11);a.d(t,'a',function(){return n.a});var i=a(40),r=a(14),o=a(38),l=a(41),s=a(5);a.d(t,'b',function(){return s.a});var d=a(42),c=a(108);a.d(t,'c',function(){return c.a});var p=a(43),g=a(109),u=a(112),m=a(37),h=a(113),y=a(114),f=a(115),v=a(116),b=a(117)},function(e,t,a){'use strict';var n=Math.PI;a.d(t,'a',function(){return i}),a.d(t,'b',function(){return r});var i=n/180,r=180/n},function(e,t,a){'use strict';function n(e){return function(t){var a,i,l=t.length,n=Array(l),r=Array(l),s=Array(l);for(a=0;a<l;++a)i=Object(o.f)(t[a]),n[a]=i.r||0,r[a]=i.g||0,s[a]=i.b||0;return n=e(n),r=e(r),s=e(s),i.opacity=1,function(e){return i.r=n(e),i.g=r(e),i.b=s(e),i+''}}}var o=a(2),i=a(14),r=a(38),l=a(4);t.a=function e(t){function a(e,t){var a=n((e=Object(o.f)(e)).r,(t=Object(o.f)(t)).r),i=n(e.g,t.g),r=n(e.b,t.b),s=Object(l.a)(e.opacity,t.opacity);return function(n){return e.r=a(n),e.g=i(n),e.b=r(n),e.opacity=s(n),e+''}}var n=Object(l.b)(t);return a.gamma=e,a}(1);var s=n(i.b),d=n(r.a)},function(e,t,a){'use strict';var r=a(14);t.a=function(e){var a=e.length;return function(n){var t=Math.floor((0>(n%=1)?++n:n)*a),i=e[(t+a-1)%a],o=e[t%a],l=e[(t+1)%a],s=e[(t+2)%a];return Object(r.a)((n-t/a)*a,i,o,l,s)}}},function(e,t){'use strict';t.a=function(e){return function(){return e}}},function(e,t,a){'use strict';var n=a(11);t.a=function(e,t){var a,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=Array(i),l=Array(i);for(a=0;a<r;++a)o[a]=Object(n.a)(e[a],t[a]);for(;a<i;++a)l[a]=t[a];return function(e){for(a=0;a<r;++a)l[a]=o[a](e);return l}}},function(e,t){'use strict';t.a=function(e,n){var i=new Date;return e=+e,n-=e,function(a){return i.setTime(e+n*a),i}}},function(e,t,a){'use strict';var n=a(11);t.a=function(e,t){var r,o={},i={};for(r in(null===e||'object'!=typeof e)&&(e={}),(null===t||'object'!=typeof t)&&(t={}),t)r in e?o[r]=Object(n.a)(e[r],t[r]):i[r]=t[r];return function(e){for(r in o)i[r]=o[r](e);return i}}},function(e,t,a){'use strict';function n(e){return function(){return e}}function r(e){return function(a){return e(a)+''}}var o=a(5),l=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d=new RegExp(l.source,'g');t.a=function(e,a){var t,c,p,g=l.lastIndex=d.lastIndex=0,u=-1,m=[],s=[];for(e+='',a+='';(t=l.exec(e))&&(c=d.exec(a));)(p=c.index)>g&&(p=a.slice(g,p),m[u]?m[u]+=p:m[++u]=p),(t=t[0])===(c=c[0])?m[u]?m[u]+=c:m[++u]=c:(m[++u]=null,s.push({i:u,x:Object(o.a)(t,c)})),g=d.lastIndex;return g<a.length&&(p=a.slice(g),m[u]?m[u]+=p:m[++u]=p),2>m.length?s[0]?r(s[0].x):n(a):(a=s.length,function(e){for(var t,n=0;n<a;++n)m[(t=s[n]).i]=t.x(e);return m.join('')})}},function(e,t,a){'use strict';var n=Math.max,i=Math.min,r=a(6),o=a(125),l=a(126),s=a(45),d=a(46),p=a(47),c=a(129),g=['y','z','a','f','p','n','\xB5','m','','k','M','G','T','P','E','Z','Y'];t.a=function(e){function t(e){function t(e){var t,i,n,s=w,d=k;if('c'===S)d=x(e)+d,e='';else{e=+e;var c=0>e;if(e=x(Math.abs(e),_),c&&0==+e&&(c=!1),s=(c?'('===l?l:'-':'-'===l||'('===l?'':l)+s,d=d+('s'===S?g[8+p.b/3]:'')+(c&&'('===l?')':''),I)for(t=-1,i=e.length;++t<i;)if(n=e.charCodeAt(t),48>n||57<n){d=(46===n?m+e.slice(t+1):e.slice(t))+d,e=e.slice(0,t);break}}b&&!f&&(e=a(e,Infinity));var u=s.length+e.length+d.length,y=u<v?Array(v-u+1).join(r):'';switch(b&&f&&(e=a(y+e,y.length?v-d.length:Infinity),y=''),o){case'<':e=s+e+d+y;break;case'=':e=s+y+e+d;break;case'^':e=y.slice(0,u=y.length>>1)+s+e+d+y.slice(u);break;default:e=y+s+e+d;}return h(e)}e=Object(s.a)(e);var r=e.fill,o=e.align,l=e.sign,c=e.symbol,f=e.zero,v=e.width,b=e.comma,_=e.precision,S=e.type,w='$'===c?u[0]:'#'===c&&/[boxX]/.test(S)?'0'+S.toLowerCase():'',k='$'===c?u[1]:/[%p]/.test(S)?y:'',x=d.a[S],I=!S||/[defgprs%]/.test(S);return _=null==_?S?6:12:/[gprs]/.test(S)?n(1,i(21,_)):n(0,i(20,_)),t.toString=function(){return e+''},t}var a=e.grouping&&e.thousands?Object(o.a)(e.grouping,e.thousands):c.a,u=e.currency,m=e.decimal,h=e.numerals?Object(l.a)(e.numerals):c.a,y=e.percent||'%';return{format:t,formatPrefix:function(a,o){var l=t((a=Object(s.a)(a),a.type='f',a)),d=3*n(-8,i(8,Math.floor(Object(r.a)(o)/3))),c=Math.pow(10,-d),p=g[8+d/3];return function(e){return l(c*e)+p}}}}},function(e,t,a){'use strict';function n(e){return new i(e)}function i(e){if(!(t=l.exec(e)))throw new Error('invalid format: '+e);var t,a=t[1]||' ',n=t[2]||'>',i=t[3]||'-',r=t[4]||'',s=!!t[5],d=t[6]&&+t[6],c=!!t[7],p=t[8]&&+t[8].slice(1),g=t[9]||'';'n'===g?(c=!0,g='g'):!o.a[g]&&(g=''),(s||'0'===a&&'='===n)&&(s=!0,a='0',n='='),this.fill=a,this.align=n,this.sign=i,this.symbol=r,this.zero=s,this.width=d,this.comma=c,this.precision=p,this.type=g}var r=Math.max;t.a=n;var o=a(46),l=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;n.prototype=i.prototype,i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?'0':'')+(null==this.width?'':r(1,0|this.width))+(this.comma?',':'')+(null==this.precision?'':'.'+r(0,0|this.precision))+this.type}},function(e,t,a){'use strict';var n=Math.round,i=a(127),r=a(47),o=a(128);t.a={"":i.a,"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return n(e).toString(2)},c:function(e){return e+''},d:function(e){return n(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return n(e).toString(8)},p:function(e,t){return Object(o.a)(100*e,t)},r:o.a,s:r.a,X:function(e){return n(e).toString(16).toUpperCase()},x:function(e){return n(e).toString(16)}}},function(e,t,a){'use strict';var r=Math.max;a.d(t,'b',function(){return o});var o,l=a(15);t.a=function(e,t){var a=Object(l.a)(e,t);if(!a)return e+'';var s=a[0],c=a[1],p=c-(o=3*r(-8,Math.min(8,Math.floor(c/3))))+1,i=s.length;return p===i?s:p>i?s+Array(p-i+1).join('0'):0<p?s.slice(0,p)+'.'+s.slice(p):'0.'+Array(1-p).join('0')+Object(l.a)(e,r(0,t+p-1))[0]}},function(e,t){'use strict';t.a={STRAVA_CLIENT_ID:'19775',STRAVA_CLIENT_SECRET:'d1fd34e8c88fc5611ff41d9361e0668e9fe676f0',STRAVA_ACCESS_TOKEN:'b4eb2c4a2517d2b916583bcbeec2aa2f6a22a8b2'}},function(e,t,a){'use strict';var n=a(133),i=a(7),r=a(16),o=a(134),l=a.n(o);class s{constructor({elevation:e,grade:t,smoothedGrade:a,distance:n,heading:i,climb:r,opposite:o,location:l}){this.elevation=e,this.grade=t,this.smoothedGrade=a,this.distance=n,this.heading=i,this.climb=r,this.opposite=o,this.location=l instanceof google.maps.LatLng?l:new google.maps.LatLng(l.lat,l.lng)}toJSON(){let{elevation:e,grade:t,smoothedGrade:a,distance:n,heading:i,climb:r,opposite:o}=this,l=this.location.toJSON();return{elevation:e,grade:t,smoothedGrade:a,distance:n,heading:i,climb:r,opposite:o,location:l}}static fromJSON(e){return new s(e)}}t.b=s;t.a=class{constructor(e){this.fileBody=e,this.md5=l()(e),this.points=[]}expandPointsWithGradeAndHeading(){for(let e,t=0;t<this.points.length;t++)if(e=this.points[t],t<this.points.length-1){let a=this.points[t+1];e.heading=google.maps.geometry.spherical.computeHeading(e.location,a.location);let n=google.maps.geometry.spherical.computeDistanceBetween(e.location,a.location),i=a.elevation-e.elevation;e.distance=n,e.grade=100*(i/n),e.opposite=i,e.climb=i}else e.distance=0,e.heading=0,e.grade=0,e.opposite=0,e.climb=0;let e=this.points.map((e,t)=>{return[t,e.grade]}),t=n.a.smooth.kernel2().kernel('Gaussian').data(e).scale(2);t();let a=t.output();for(let e=0;e<this.points.length;e++)this.points[e].smoothedGrade=a[e][1],(0.95>this.points[e].smoothedGrade||0>this.points[e].climb)&&(this.points[e].climb=0)}async expandPointsWithElevation(e){let t=0,a=20,n=512;for(;t<e.length;){0<t&&(await Object(i.d)(4e3));let o=[],l=0,d=0;for(let i=t;i<e.length;i++){let t=e[i],r=0;if(i<e.length-1){let a=e[i+1];r=google.maps.geometry.spherical.computeDistanceBetween(t.location,a.location)}if(l+=r,d+=1,l<=n*a&&d<n)o.push(t.location);else{d-=1,l-=r;break}}let c={path:o,samples:Math.ceil(l/a)},p=await Object(r.b)(c),g=p.map((t)=>{return new s({elevation:t.elevation,location:t.location})});Array.prototype.push.apply(this.points,g),t=d+t}}async create(){if(localStorage.getItem(this.md5)){let e=JSON.parse(localStorage.getItem(this.md5));this.points=e.map((e)=>{return s.fromJSON(e)})}else{let e=new DOMParser,t=e.parseFromString(this.fileBody,'text/xml'),a=Array.from(t.documentElement.getElementsByTagName('trkpt')).map((e)=>{let t=parseFloat(e.getAttribute('lat')),a=parseFloat(e.getAttribute('lon'));return new s({location:{lat:t,lng:a}})});await this.expandPointsWithElevation(a),this.expandPointsWithGradeAndHeading(),localStorage.setItem(this.md5,JSON.stringify(this.points))}return this.points}}},function(e,t,a){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=a(51);document.addEventListener('DOMContentLoaded',()=>{Object(n.a)()})},function(e,t,a){'use strict';function n(){return JSON.parse(localStorage.getItem('route-progress'))||[]}function i(e){let t=n();t=t.filter((t)=>t!==e.cacheName()),t.unshift(e.cacheName()),localStorage.setItem('route-progress',JSON.stringify(t))}function r(e){let t=n();t=t.filter((t)=>t!==e.cacheName()),localStorage.removeItem(e.cacheName()),localStorage.setItem('route-progress',JSON.stringify(t))}function o(e){let t=n();if(t.unshift(e.cacheName()),3<t.length){let e=t.shift();localStorage.removeItem(e)}localStorage.setItem('route-progress',JSON.stringify(t))}t.a=function(){let e=new URL(window.location),t=new u.a(e.search);if(t.get('state')&&t.get('code')){let e=t.get('code');return localStorage.setItem('strava-oauth-code-'+c.a.STRAVA_CLIENT_ID,e),void window.location.assign('/')}let a=window.location.protocol;if('https:'!==a){let e=window.location.host;window.location.assign('https://'+e+'/')}(c.a.STRAVA_CLIENT_ID===void 0||null===c.a.STRAVA_CLIENT_ID||''===c.a.STRAVA_CLIENT_ID)&&(document.getElementById('container-strava').style.display='none'),localStorage.getItem('strava-oauth-code-'+c.a.STRAVA_CLIENT_ID)&&(document.getElementById('strava-btn-connect').style.display='none',document.getElementById('strava-btn-connected').style.display='block'),'undefined'!=typeof navigator&&'bluetooth'in navigator?(document.getElementById('btn-bluetooth-device').style.display='inline-block',document.getElementById('btn-bluetooth-device-warning').style.display='none'):(document.getElementById('btn-bluetooth-device').style.display='none',document.getElementById('btn-bluetooth-device-warning').style.display='block');let g=n(),m=document.getElementById('continue-previous');for(let e of g){var h=document.createElement('option');let t=JSON.parse(localStorage.getItem(e)),a=new Date;a.setTime(t.id),h.innerHTML=a.toLocaleDateString()+' '+a.toLocaleTimeString()+' - '+t.routeName,h.setAttribute('value',e),m.add(h)}let y,f=[['virtual',new p.f]],v=[],b=[],_=document.getElementById('gpx-file-upload'),S=document.getElementById('display-unit'),w=document.getElementById('rider-weight'),k=document.getElementById('begin-session'),x=document.getElementById('btn-bluetooth-device-txt'),I=document.getElementById('strava-btn-connect'),E=document.getElementById('btn-bluetooth-device'),T=document.getElementById('power-meter'),L=document.getElementById('hr-meter'),C=document.getElementById('cadence-meter'),M=document.getElementById('menuopen-btn');for(let e of document.querySelectorAll('#route-nav a'))e.onclick=(t)=>{t.preventDefault();let e=t.target.getAttribute('href');for(let e of document.querySelectorAll('.nav-link'))e.classList.remove('active');t.target.classList.add('active');for(let e of document.querySelectorAll('.tab-pane'))e.classList.remove('active');document.querySelector(e).classList.add('active')};S.onchange=()=>{'imperial'===S.value?(document.getElementById('rider-weight-label').innerHTML='Rider Weight (lbs)',document.getElementById('rider-weight').setAttribute('placeholder',185)):(document.getElementById('rider-weight-label').innerHTML='Rider Weight (kg)',document.getElementById('rider-weight').setAttribute('placeholder',85))},M.onclick=(t)=>{t.preventDefault(),'none'===document.getElementById('ui-finalize-container').style.display?y.showFinalizeUI('Complete Ride'):document.getElementById('ui-finalize-container').style.display='none'},I.onclick=(t)=>{t.preventDefault();let e=window.location.protocol,a=window.location.host;window.location.assign('https://www.strava.com/oauth/authorize?client_id='+c.a.STRAVA_CLIENT_ID+'&response_type=code&redirect_uri='+(e+'//'+a+'/')+'&scope=write&state=strava')},E.onclick=(t)=>{if(t.preventDefault(),!E.classList.contains('disabled'))E.classList.add('disabled');else return;x.innerHTML='Connecting ...',async function(){let e=await navigator.bluetooth.requestDevice({filters:[{services:[6157]},{services:[6168]},{services:[6166]}]}),t=await e.gatt.connect(),a=await t.getPrimaryServices();for(let n of a){let a=parseInt(n.uuid.substring(0,8),16);if(6168===a){if(f.find((t)=>t[0]===e.id))continue;let a=await n.getCharacteristic(10851),i=new p.e,r=await Object(d.c)(a),o=i.getData(r);if('cumulative_crank_revolutions'in o){let i=new p.c(e,t,n,a);f.push([i.id,i]),b.push([i.id,i])}else{let i=new p.d(e,t,n,a);f.push([i.id,i])}}else if(6166===a){if(b.find((t)=>t[0]===e.id))continue;let a=await n.getCharacteristic(10843),i=new p.a(e,t,n,a);b.push([i.id,i])}else if(6157===a){if(v.find((t)=>t[0]===e.id))continue;let a=await n.getCharacteristic(10807),i=new p.b(e,t,n,a);v.push([i.id,i])}}T.options.length=0;for(let[t,a]of f){var n=document.createElement('option');n.innerHTML=a.name,n.setAttribute('value',a.id),a.id===e.id&&n.setAttribute('selected','true'),T.add(n)}L.options.length=0;for(let[t,a]of v){var n=document.createElement('option');n.innerHTML=a.name,n.setAttribute('value',a.id),a.id===e.id&&n.setAttribute('selected','true'),L.options.add(n)}if(0===L.options.length){var n=document.createElement('option');n.innerHTML='Disabled',n.setAttribute('value',''),L.options.add(n)}C.options.length=0;for(let[t,a]of b){var n=document.createElement('option');n.innerHTML=a.name,n.setAttribute('value',a.id),a.id===e.id&&n.setAttribute('selected','true'),C.options.add(n)}if(0===C.options.length){var n=document.createElement('option');n.innerHTML='Disabled',n.setAttribute('value',''),C.options.add(n)}E.classList.remove('disabled'),x.innerHTML='Connect'}().catch((e)=>{E.classList.remove('disabled'),x.innerHTML='Connect',console.log('Error: ',e)})},k.onclick=(t)=>{if(t.preventDefault(),(_.value||m.value)&&w.value){if(!k.classList.contains('disabled'))k.classList.add('disabled');else return;(async function(){let e=w.value,t=S.value,a=T.value,n=f.find((e)=>e[0]===a)[1];n.listen();let c,p=L.value;p&&(c=v.find((e)=>e[0]===p)[1],c.listen());let g,u=C.value;if(u&&(g=b.find((e)=>e[0]===u)[1],g.listen()),localStorage.setItem('form-weight',e),localStorage.setItem('form-unit',t),l.a.transitionUI(),m.value){let e=JSON.parse(localStorage.getItem(m.value));y=l.a.fromJSON(e),y.powerMeter=n,y.heartMeter=c,y.cadenceMeter=g,i(y)}else{let a=await Object(d.b)(_.files[0]),i=new s.a(a),r=await i.create();y=new l.a({points:r,riderWeight:e,unit:t,powerMeter:n,heartMeter:c,cadenceMeter:g}),o(y)}await y.init(),y.updateUI(),await y.updatePosition(),r(y),y.showFinalizeUI('Ride Finished')})().catch((e)=>{console.log('Error: ',e)})}else{let e='';_.value||m.value?!w.value&&(e='Please enter the riders weight.'):e='Please select a GPX file.';let t=document.getElementById('messages');t.innerHTML=e,t.style.display='block',window.scrollTo(0,0)}},localStorage.getItem('form-weight')&&(w.value=localStorage.getItem('form-weight')),localStorage.getItem('form-unit')&&(S.value=localStorage.getItem('form-unit'),S.onchange())};var l=a(52),s=a(49),d=a(7),c=a(48),p=a(135),g=a(136),u=a.n(g)},function(e,t,a){'use strict';var n=Math.floor,i=a(16),r=a(7),o=a(53),l=a(54),s=a(55),d=a.n(s),c=a(56),p=a(48),g=a(49);class u{constructor({id:e,powerMeter:t,heartMeter:a,cadenceMeter:n,riderWeight:i,unit:r,routeName:s='',history:d=[],points:o,ridingState:l}){this.id=e,this.powerMeter=t,this.heartMeter=a,this.cadenceMeter=n,this.riderWeight=i,this.unit=r,this.routeName=s,this.history=d,this.points=o,this.ridingState=l,this.powerSamples=[],(this.id===void 0||null===this.id)&&(this.id=new Date().getTime()),'string'==typeof this.riderWeight&&(this.riderWeight=parseInt(this.riderWeight)),(this.ridingState===void 0||null===this.ridingState)&&(this.ridingState={pointIdx:0,point:this.points[0],pointPct:0,lastSampleTime:new Date,location:this.points[0].location,elevation:this.points[0].elevation,average_grade:0,mapMode:'SV',watts:0,rpm:void 0,bpm:void 0,speed:0,distance:0,climb:0,elapsed:0})}async init(){this.miniMap=new google.maps.Map(document.getElementById('tracker'),{center:this.ridingState.point.location,zoom:14,fullscreenControl:!1,zoomControl:!0,mapTypeId:google.maps.MapTypeId.TERRAIN});let e=this.points.map((e)=>{return{lat:e.location.lat(),lng:e.location.lng()}}),t=new google.maps.Polyline({path:e,geodesic:!0,strokeColor:'#0c7ac9',strokeOpacity:1,strokeWeight:2});t.setMap(this.miniMap),this.fullMap=new google.maps.Map(document.getElementById('map-view'),{center:this.ridingState.point.location,zoom:18,fullscreenControl:!1,zoomControl:!0,mapTypeId:google.maps.MapTypeId.TERRAIN});let a=new google.maps.Polyline({path:e,geodesic:!0,strokeColor:'#0c7ac9',strokeOpacity:1,strokeWeight:2});a.setMap(this.fullMap),this.fullMarker=new google.maps.Marker({position:this.ridingState.point.location,map:this.fullMap,icon:'/images/here.png'}),this.fullMarker.setMap(this.fullMap);let n=this.streetViewPanoramaInit(this.ridingState.point.location,this.ridingState.point.heading);this.miniMap.setStreetView(n),this.zoomSvg=c.a.select('#ui-elevation').append('svg').attr('id','ui-elevation-svg').attr('x',0).attr('y',0).attr('viewBox','0 0 150 60').attr('preserveAspectRatio','none'),this.drawHeightMap(),this.powerMeter.addListener('power',(e)=>this.collectPower(e)),this.heartMeter&&this.heartMeter.addListener('hr',(e)=>this.collectHR(e)),this.cadenceMeter&&this.cadenceMeter.addListener('cadence',(e)=>this.collectCadence(e));let o=await Object(i.a)(this.points[0].location),l=['street_address','route','intersection','postal_code'];for(let e of o){let t='';if(0<e.types.length&&(t=e.types[0]),l.includes(t))continue;else{this.routeName=e.formatted_address;break}}}collectPower(e){this.powerSamples.push(e)}collectHR(e){this.ridingState.bpm=e}collectCadence(e){this.ridingState.rpm=e}streetViewPanoramaInit(e,t){let a=document.getElementById('street-view');a.innerHTML='';let n=new google.maps.StreetViewPanorama(a,{visible:!0,fullscreenControl:!1,clickToGo:!1,addressControl:!1,panControl:!1,zoomControl:!1,linksControl:!1,pov:{heading:t,pitch:0},position:e});return n.addListener('status_changed',()=>{n.setPov({heading:this.ridingState.point.heading,pitch:0})}),n}drawHeightMap(){this.fullSvg=c.a.select('#ui-heightmap').append('svg').attr('id','ui-heightmap-svg').attr('x',0).attr('y',0).attr('viewBox','0 0 150 37.5').attr('preserveAspectRatio','none'),this.fullSvgData=[];for(let e=0;e<this.points.length;e++)this.fullSvgData.push([e,this.points[e].elevation]);let[e,t]=c.a.extent(this.fullSvgData,(e)=>e[1]);125>t-e&&(t=e+125);const a=c.a.scaleLinear().domain([t,e]).range([6,33]),n=c.a.scaleLinear().domain([0,this.points.length-1]).range([0,150]);this.fullSvgData=this.fullSvgData.map((e)=>{return[n(e[0]),a(e[1])]}),this.fullSvgData.push([150,37.5]),this.fullSvgData.push([0,37.5]),this.fullSvgData.push([0,this.fullSvgData[0][1]]);let i=this.fullSvg.selectAll('polygon').data([this.fullSvgData]).attr('points',(e)=>{return e.map((e)=>{return[e[0],e[1]].join(',')}).join(' ')});i.enter().append('polygon').attr('points',(e)=>{return e.map((e)=>{return[e[0],e[1]].join(',')}).join(' ')}).attr('fill','#31A3CC').attr('stroke','#31A3CC').attr('stroke-width','1')}updateGraphs(){let e=Array(101);for(let t,a=0;a<e.length;a++)t=a-50+this.ridingState.pointIdx,0>t&&(t=0),t>=this.points.length&&(t=this.points.length-1),e[a]=[a,this.points[t].elevation];let[t,a]=c.a.extent(e,(e)=>e[1]);50>a-t&&(a=t+50);const n=c.a.scaleLinear().domain([a,t]).range([15,60-0.32*60]),i=c.a.scaleLinear().domain([0,100]).range([0,150]);e=e.map((e)=>{return[i(e[0]),n(e[1])]}),e.push([150,60]),e.push([0,60]),e.push([0,e[0][1]]);let r=this.zoomSvg.selectAll('polygon').data([e]).attr('points',(e)=>{return e.map((e)=>{return[e[0],e[1]].join(',')}).join(' ')});r.enter().append('polygon').attr('points',(e)=>{return e.map((e)=>{return[e[0],e[1]].join(',')}).join(' ')}).attr('fill','#31A3CC').attr('stroke','#31A3CC').attr('stroke-width','1');let o=this.zoomSvg.selectAll('image').data([e[51]]).attr('x',(e)=>{return e[0]-7.5}).attr('y',(e)=>{return e[1]-15}).attr('width','15').attr('height','15').attr('xlink:href','/images/marker.svg');o.enter().append('image').attr('x',(e)=>{e[0]}).attr('y',(e)=>{e[1]});let l=this.fullSvg.selectAll('image').data([this.fullSvgData[this.ridingState.pointIdx]]).attr('x',(e)=>{return e[0]-3}).attr('y',(e)=>{return e[1]-6}).attr('width','6').attr('height','6').attr('xlink:href','/images/marker.svg');l.enter().append('image').attr('x',(e)=>{e[0]}).attr('y',(e)=>{e[1]})}async updatePosition(){for(let e=0;;){this.powerSamples.length&&(this.ridingState.watts=this.powerSamples.reduce((e,t)=>e+t,0)/this.powerSamples.length,this.powerSamples.length=0);let t=new Date,a=(t-this.ridingState.lastSampleTime)/1e3;this.ridingState.lastSampleTime=t;let n=1,o=0,l=0;for(;0<n;){let e=this.speedFromPower(this.ridingState.watts,this.ridingState.point.smoothedGrade,this.ridingState.point.elevation),t=this.ridingState.speed+0.2*(e-this.ridingState.speed);0.447>t&&(t=0);let i=t*a*n,r=this.ridingState.point.distance-this.ridingState.point.distance*this.ridingState.pointPct;if(i>r){let e=r/i;if(l+=this.ridingState.point.smoothedGrade*e,n-=n*e,this.ridingState.pointIdx+=1,this.ridingState.pointPct=0,this.ridingState.climb+=this.ridingState.point.climb,this.ridingState.point=this.points[this.ridingState.pointIdx],o+=r,this.ridingState.pointIdx>=this.points.length)break}else{let e=n;l+=this.ridingState.point.smoothedGrade*e,n=0,0==r?this.ridingState.pointPct=0:(this.ridingState.pointPct=1-(r-i)/this.ridingState.point.distance,o+=i)}}if(this.ridingState.pointIdx>=this.points.length)break;if(this.ridingState.average_grade=l,this.ridingState.distance+=o,this.ridingState.elevation=this.ridingState.point.elevation+this.ridingState.point.opposite*this.ridingState.pointPct,this.ridingState.speed=o/a,0<this.ridingState.speed&&(this.ridingState.elapsed+=a),this.ridingState.location=google.maps.geometry.spherical.interpolate(this.ridingState.point.location,this.points[this.ridingState.pointIdx+1].location,this.ridingState.pointPct),this.history.push({time:t,location:this.ridingState.location,power:this.ridingState.watts,elevation:this.ridingState.elevation,hr:this.ridingState.bpm,cad:this.ridingState.rpm}),0==e%5){let e=this.miniMap.getStreetView();try{let t=await Object(i.c)(this.ridingState.location,50);'profileUrl'in t.location||('MV'===this.ridingState.mapMode&&(document.getElementById('map-view').style.display='none',document.getElementById('tracker').style.display='block',document.getElementById('street-view').style.display='block',e.setVisible(!0),google.maps.event.trigger(e,'resize'),google.maps.event.trigger(this.miniMap,'resize')),this.miniMap.panTo(this.ridingState.location),'MV'===this.ridingState.mapMode?e.setPano(t.location.pano):e.setPosition(this.ridingState.location),this.ridingState.mapMode='SV')}catch(t){'SV'===this.ridingState.mapMode&&(e.setVisible(!1),document.getElementById('street-view').style.display='none',document.getElementById('tracker').style.display='none',document.getElementById('map-view').style.display='block',google.maps.event.trigger(this.fullMap,'resize')),this.ridingState.mapMode='MV',this.fullMap.panTo(this.ridingState.location),this.fullMarker.setPosition(this.ridingState.location)}}0==e%30&&Promise.resolve().then(()=>{localStorage.setItem(this.cacheName(),JSON.stringify(this.toJSON()))}),this.updateGraphs(),e+=1,await Object(r.d)(1e3)}}speedFromPower(e,t,a){let n=1e3*Math.exp(-a/7e3),i={units:'metric',rp_wr:this.riderWeight*('imperial'===this.unit?0.453592:1),rp_wb:8,rp_a:0.65,rp_cd:0.63,rp_dtl:4,ep_crr:5e-3,ep_g:t,ep_rho:Object(o.a)(23.8889,n,7.5)},r=Object(l.a)(e,i);return r*=0.277778,r}async updateUI(){for(;;){let e=this.ridingState.elapsed.toFixed(),t=n(e/3600),a=n((e-3600*t)/60),i=e-3600*t-60*a;10>a&&(a='0'+a),10>i&&(i='0'+i);let o=0===t?a+':'+i:t+':'+a+':'+i;let l=this.ridingState.distance*('imperial'===this.unit?6.21371e-4:1e-3);l=100<l?l.toFixed():l.toFixed(1);let s=this.ridingState.average_grade.toFixed(1);('-0'===s||'-0.0'===s)&&(s='0.0');let d=document.getElementById('grade-unit-icon');0<=s?d.classList.contains('fa-long-arrow-down')&&(d.classList.remove('fa-long-arrow-down'),d.classList.add('fa-long-arrow-up')):d.classList.contains('fa-long-arrow-up')&&(d.classList.remove('fa-long-arrow-up'),d.classList.add('fa-long-arrow-down'));let c=this.ridingState.watts;c=void 0!==c&&null!==c?c.toFixed():'--';let p=this.ridingState.bpm;p=void 0!==p&&null!==p?p.toFixed():'--';let g=this.ridingState.rpm;g=void 0!==g&&null!==g?g.toFixed():'--',document.getElementById('watts').innerHTML=c,document.getElementById('heart').innerHTML=p,document.getElementById('cadence').innerHTML=g,document.getElementById('speed').innerHTML=(this.ridingState.speed*('imperial'===this.unit?2.23694:3.6)).toFixed(),document.getElementById('distance').innerHTML=l,document.getElementById('climb').innerHTML=(this.ridingState.climb*('imperial'===this.unit?3.28084:1)).toFixed(),document.getElementById('time').innerHTML=o,document.getElementById('grade').innerHTML=s,document.getElementById('distance-unit-value').innerHTML='imperial'===this.unit?'mi':'&nbsp;km',document.getElementById('speed-unit-value').innerHTML='imperial'===this.unit?'mph':'kph',document.getElementById('climb-container-value').innerHTML='imperial'===this.unit?'ft':'m',await Object(r.d)(1e3)}}async stravaExport(){let e=document.getElementById('btn-export-strava');if(!e.classList.contains('disabled'))e.classList.add('disabled');else return;e.innerHTML='Exporting';let t=document.getElementById('input-ride-name'),a=t.value,n=document.getElementById('strava-gpx-template').innerHTML,i=this.history.map((e)=>{return{lat:e.location.lat(),lng:e.location.lng(),elevation:e.elevation.toFixed(5),time:Object(r.a)(e.time),power:e.power,hr:e.hr,cad:e.cad}}),o=d.a.render(n,{export_time:Object(r.a)(new Date),export_name:a,points:i}),l=new FormData;l.set('client_id',p.a.STRAVA_CLIENT_ID),l.set('client_secret',p.a.STRAVA_CLIENT_SECRET),l.set('code',localStorage.getItem('strava-oauth-code-'+p.a.STRAVA_CLIENT_ID));let s=await fetch('https://www.strava.com/oauth/token',{method:'POST',body:l}),c=await s.json(),g=c.access_token,u=new File([o],'import_to_strava.gpx',{type:'text/xml'}),m=new FormData;m.set('activity_type','virtualride'),m.set('name',a),m.set('data_type','gpx'),m.set('file',u);let h=new Headers;h.set('Authorization','Bearer '+g);let y=await fetch('https://www.strava.com/api/v3/uploads',{method:'POST',headers:h,body:m}),f=await y.json(),v=f.id;for(;;){let e=await fetch('https://www.strava.com/api/v3/uploads/'+v,{headers:h}),t=await e.json();if(t.activity_id)break;await Object(r.d)(4e3)}e.innerHTML='Done!'}showFinalizeUI(e){if(document.getElementById('ui-finalize-container').style.display='block',document.getElementById('ui-finalize-label').innerHTML=e,localStorage.getItem('strava-oauth-code-'+p.a.STRAVA_CLIENT_ID)){let e=new Date,t='GPedal.com - ';t+=this.routeName?this.routeName:e.getMonth()+1+'/'+e.getDate();let a=document.getElementById('input-ride-name');a.value=t,a.style.display='block';let n=document.getElementById('btn-export-strava');n.style.display='block',n.onclick=(t)=>{t.preventDefault(),this.stravaExport().catch((e)=>{console.log('Error: ',e)})}}}cacheName(){return'route-progress-'+this.id}toJSON(){let{history:e,id:t,points:a,riderWeight:n,ridingState:i,routeName:r,unit:o}=this;return e=e.map((e)=>{return e=Object.assign({},e),e.location=e.location.toJSON(),e.time=e.time.toJSON(),e}),a=a.map((e)=>{return e.toJSON()}),i=Object.assign({},i),i.lastSampleTime=i.lastSampleTime.toJSON(),i.location=i.location.toJSON(),i.point=i.point.toJSON(),i.bpm=void 0,i.rpm=void 0,i.speed=0,i.watts=0,{history:e,id:t,points:a,riderWeight:n,ridingState:i,routeName:r,unit:o}}static fromJSON(e){for(let t of e.history)t.location=new google.maps.LatLng(t.location.lat,t.location.lng),t.time=new Date(t.time);return e.points=e.points.map((e)=>{return g.b.fromJSON(e)}),e.ridingState.lastSampleTime=new Date(e.ridingState.lastSampleTime),e.ridingState.location=new google.maps.LatLng(e.ridingState.location.lat,e.ridingState.location.lng),e.ridingState.point=g.b.fromJSON(e.ridingState.point),new u(e)}static transitionUI(){document.getElementById('configure-container').style.display='none',document.getElementById('app-container').style.display='block'}}t.a=u},function(e,t){'use strict';t.a=function(e,t,a){var n=6.1078/Math.pow(0.99999683+a*(-0.0090826951+a*(7.8736169e-5+a*(-6.1117958e-7+a*(4.3884187e-9+a*(-2.9883885e-11+a*(2.1874425e-13+a*(-1.7892321e-15+a*(1.1112018e-17+a*-3.0994571e-20)))))))),8),i=100*n;return(100*t-i)/(287.0531*(e+273.15))+i/(461.4964*(e+273.15))}},function(e,t){'use strict';function a(e,t){var a=9.8067*(t.rp_wr+t.rp_wb)*Math.sin(i(t.ep_g/100)),n=9.8067*(t.rp_wr+t.rp_wb)*Math.cos(i(t.ep_g/100))*t.ep_crr,r=0.5*t.rp_a*t.rp_cd*t.ep_rho*(1e3*e/3600)*(1e3*e/3600),o={};return o.Fgravity=a,o.Frolling=n,o.Fdrag=r,o}function n(e,t){var n=a(e,t),i=n.Fgravity+n.Frolling+n.Fdrag,r=i*(1e3*e/3600)/(1-t.rp_dtl/100);return r}var i=Math.atan;t.a=function(e,t){var a=-1e3,i=1e3,r=0,o=n(r,t),l=0;do{if(Math.abs(o-e)<1e-6)break;o>e?i=r:a=r,r=(i+a)/2,o=n(r,t)}while(100>l++);return r}},function(e,t){var a,n,i;(function(r,o){'object'==typeof t&&t&&'string'!=typeof t.nodeName?o(t):(n=[t],a=o,i='function'==typeof a?a.apply(t,n):a,!(i!==void 0&&(e.exports=i)))})(this,function(e){function t(e){return'function'==typeof e}function a(e){return m(e)?'array':typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&')}function i(e,t){return null!=e&&'object'==typeof e&&t in e}function r(e,t){return h.call(e,t)}function o(e){return!r(y,e)}function l(t,a){function r(){if(k&&!x)for(;f.length;)delete y[f.pop()];else f=[];k=!1,x=!1}function l(e){if('string'==typeof e&&(e=e.split(b,2)),!m(e)||2!==e.length)throw new Error('Invalid tags: '+e);p=new RegExp(n(e[0])+'\\s*'),g=new RegExp('\\s*'+n(e[1])),u=new RegExp('\\s*'+n('}'+e[1]))}if(!t)return[];var p,g,u,h=[],y=[],f=[],k=!1,x=!1;l(a||e.tags);for(var I,E,T,L,C,M,A=new c(t);!A.eos();){if(I=A.pos,T=A.scanUntil(p),T)for(var B=0,i=T.length;B<i;++B)L=T.charAt(B),o(L)?f.push(y.length):x=!0,y.push(['text',L,I,I+1]),I+=1,'\n'===L&&r();if(!A.scan(p))break;if(k=!0,E=A.scan(w)||'name',A.scan(v),'='===E?(T=A.scanUntil(_),A.scan(_),A.scanUntil(g)):'{'===E?(T=A.scanUntil(u),A.scan(S),A.scanUntil(g),E='&'):T=A.scanUntil(g),!A.scan(g))throw new Error('Unclosed tag at '+A.pos);if(C=[E,T,I,A.pos],y.push(C),'#'===E||'^'===E)h.push(C);else if('/'===E){if(M=h.pop(),!M)throw new Error('Unopened section "'+T+'" at '+I);if(M[1]!==T)throw new Error('Unclosed section "'+M[1]+'" at '+I)}else'name'===E||'{'===E||'&'===E?x=!0:'='===E&&l(T)}if(M=h.pop(),M)throw new Error('Unclosed section "'+M[1]+'" at '+A.pos);return d(s(y))}function s(e){for(var t,a,n=[],r=0,i=e.length;r<i;++r)t=e[r],t&&('text'===t[0]&&a&&'text'===a[0]?(a[1]+=t[1],a[3]=t[3]):(n.push(t),a=t));return n}function d(e){for(var t,a,n=[],r=n,o=[],l=0,i=e.length;l<i;++l)switch(t=e[l],t[0]){case'#':case'^':r.push(t),o.push(t),r=t[4]=[];break;case'/':a=o.pop(),a[5]=t[2],r=0<o.length?o[o.length-1][4]:n;break;default:r.push(t);}return n}function c(e){this.string=e,this.tail=e,this.pos=0}function p(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.cache={}}var u=Object.prototype.toString,m=Array.isArray||function(e){return'[object Array]'===u.call(e)},h=RegExp.prototype.test,y=/\S/,f={"&":'&amp;',"<":'&lt;',">":'&gt;','"':'&quot;',"'":'&#39;',"/":'&#x2F;',"`":'&#x60;',"=":'&#x3D;'},v=/\s*/,b=/\s+/,_=/\s*=/,S=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/;c.prototype.eos=function(){return''===this.tail},c.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return'';var a=t[0];return this.tail=this.tail.substring(a.length),this.pos+=a.length,a},c.prototype.scanUntil=function(e){var t,a=this.tail.search(e);return-1===a?(t=this.tail,this.tail=''):0===a?t='':(t=this.tail.substring(0,a),this.tail=this.tail.substring(a)),this.pos+=t.length,t},p.prototype.push=function(e){return new p(e,this)},p.prototype.lookup=function(e){var a,n=this.cache;if(n.hasOwnProperty(e))a=n[e];else{for(var r,o,l=this,s=!1;l;){if(0<e.indexOf('.'))for(a=l.view,r=e.split('.'),o=0;null!=a&&o<r.length;)o===r.length-1&&(s=i(a,r[o])),a=a[r[o++]];else a=l.view[e],s=i(l.view,e);if(s)break;l=l.parent}n[e]=a}return t(a)&&(a=a.call(this.view)),a},g.prototype.clearCache=function(){this.cache={}},g.prototype.parse=function(e,t){var a=this.cache,n=a[e];return null==n&&(n=a[e]=l(e,t)),n},g.prototype.render=function(e,t,a){var n=this.parse(e),i=t instanceof p?t:new p(t);return this.renderTokens(n,i,a,e)},g.prototype.renderTokens=function(e,t,a,n){for(var r,o,l,s='',d=0,i=e.length;d<i;++d)l=void 0,r=e[d],o=r[0],'#'===o?l=this.renderSection(r,t,a,n):'^'===o?l=this.renderInverted(r,t,a,n):'>'===o?l=this.renderPartial(r,t,a,n):'&'===o?l=this.unescapedValue(r,t):'name'===o?l=this.escapedValue(r,t):'text'===o&&(l=this.rawValue(r)),void 0!==l&&(s+=l);return s},g.prototype.renderSection=function(e,a,n,i){function r(e){return o.render(e,a,n)}var o=this,l='',s=a.lookup(e[1]);if(s){if(m(s))for(var d=0,c=s.length;d<c;++d)l+=this.renderTokens(e[4],a.push(s[d]),n,i);else if('object'==typeof s||'string'==typeof s||'number'==typeof s)l+=this.renderTokens(e[4],a.push(s),n,i);else if(t(s)){if('string'!=typeof i)throw new Error('Cannot use higher-order sections without the original template');s=s.call(a.view,i.slice(e[3],e[5]),r),null!=s&&(l+=s)}else l+=this.renderTokens(e[4],a,n,i);return l}},g.prototype.renderInverted=function(e,t,a,n){var i=t.lookup(e[1]);if(!i||m(i)&&0===i.length)return this.renderTokens(e[4],t,a,n)},g.prototype.renderPartial=function(e,a,n){if(n){var i=t(n)?n(e[1]):n[e[1]];if(null!=i)return this.renderTokens(this.parse(i),a,n,i)}},g.prototype.unescapedValue=function(e,t){var a=t.lookup(e[1]);if(null!=a)return a},g.prototype.escapedValue=function(t,a){var n=a.lookup(t[1]);if(null!=n)return e.escape(n)},g.prototype.rawValue=function(e){return e[1]},e.name='mustache.js',e.version='2.3.0',e.tags=['{{','}}'];var k=new g;return e.clearCache=function(){return k.clearCache()},e.parse=function(e,t){return k.parse(e,t)},e.render=function(e,t,n){if('string'!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+a(e)+'" was given as the first argument for mustache#render(template, view, partials)');return k.render(e,t,n)},e.to_html=function(a,n,i,r){var o=e.render(a,n,i);return t(r)?void r(o):o},e.escape=function(e){return(e+'').replace(/[&<>"'`=\/]/g,function(e){return f[e]})},e.Scanner=c,e.Context=p,e.Writer=g,e})},function(e,t,a){'use strict';var n=a(57),i=a(89),r=a(9);const o={select:n.a,scaleLinear:i.a,extent:r.a};t.a=o},function(e,t,a){'use strict';var n=a(0);t.a=function(e){return'string'==typeof e?new n.a([[document.querySelector(e)]],[document.documentElement]):new n.a([[e]],n.b)}},function(e,t,a){'use strict';var r=a(0),o=a(17);t.a=function(e){'function'!=typeof e&&(e=Object(o.a)(e));for(var t=this._groups,a=t.length,l=Array(a),s=0;s<a;++s)for(var d,c,p=t[s],g=p.length,n=l[s]=Array(g),u=0;u<g;++u)(d=p[u])&&(c=e.call(d,d.__data__,u,p))&&('__data__'in d&&(c.__data__=d.__data__),n[u]=c);return new r.a(l,this._parents)}},function(e,t,a){'use strict';var r=a(0),o=a(60);t.a=function(e){'function'!=typeof e&&(e=Object(o.a)(e));for(var t=this._groups,a=t.length,l=[],s=[],d=0;d<a;++d)for(var c,p=t[d],g=p.length,n=0;n<g;++n)(c=p[n])&&(l.push(e.call(c,c.__data__,n,p)),s.push(c));return new r.a(l,s)}},function(e,t){'use strict';function a(){return[]}t.a=function(e){return null==e?a:function(){return this.querySelectorAll(e)}}},function(e,t,a){'use strict';var r=a(0),o=a(62);t.a=function(e){'function'!=typeof e&&(e=Object(o.a)(e));for(var t=this._groups,a=t.length,l=Array(a),s=0;s<a;++s)for(var d,c=t[s],p=c.length,n=l[s]=[],g=0;g<p;++g)(d=c[g])&&e.call(d,d.__data__,g,c)&&n.push(d);return new r.a(l,this._parents)}},function(e,t){'use strict';var a=function(e){return function(){return this.matches(e)}};if('undefined'!=typeof document){var n=document.documentElement;if(!n.matches){var i=n.webkitMatchesSelector||n.msMatchesSelector||n.mozMatchesSelector||n.oMatchesSelector;a=function(e){return function(){return i.call(this,e)}}}}t.a=a},function(e,t,a){'use strict';function n(e,t,a,n,r,l){for(var s,d=0,i=t.length,c=l.length;d<c;++d)(s=t[d])?(s.__data__=l[d],n[d]=s):a[d]=new o.a(e,l[d]);for(;d<i;++d)(s=t[d])&&(r[d]=s)}function i(e,t,a,n,r,l,d){var c,i,p,g={},u=t.length,m=l.length,h=Array(u);for(c=0;c<u;++c)(i=t[c])&&(h[c]=p=s+d.call(i,i.__data__,c,t),p in g?r[c]=i:g[p]=i);for(c=0;c<m;++c)p=s+d.call(e,l[c],c,l),(i=g[p])?(n[c]=i,i.__data__=l[c],g[p]=null):a[c]=new o.a(e,l[c]);for(c=0;c<u;++c)(i=t[c])&&g[h[c]]===i&&(r[c]=i)}var r=a(0),o=a(18),l=a(64),s='$';t.a=function(e,t){if(!e)return f=Array(this.size()),u=-1,this.each(function(e){f[++u]=e}),f;var a=t?i:n,o=this._parents,s=this._groups;'function'!=typeof e&&(e=Object(l.a)(e));for(var d=s.length,c=Array(d),p=Array(d),g=Array(d),u=0;u<d;++u){var m=o[u],h=s[u],y=h.length,f=e.call(m,m&&m.__data__,u,o),v=f.length,b=p[u]=Array(v),_=c[u]=Array(v),S=g[u]=Array(y);a(m,h,b,_,S,f,t);for(var w,k,x=0,I=0;x<v;++x)if(w=b[x]){for(x>=I&&(I=x+1);!(k=_[I])&&++I<v;);w._next=k||null}}return c=new r.a(c,o),c._enter=p,c._exit=g,c}},function(e,t){'use strict';t.a=function(e){return function(){return e}}},function(e,t,a){'use strict';var n=a(19),i=a(0);t.a=function(){return new i.a(this._exit||this._groups.map(n.a),this._parents)}},function(e,t,a){'use strict';var r=a(0);t.a=function(e){for(var t=this._groups,a=e._groups,o=t.length,l=a.length,s=Math.min(o,l),d=Array(o),c=0;c<s;++c)for(var p,g=t[c],u=a[c],m=g.length,n=d[c]=Array(m),h=0;h<m;++h)(p=g[h]||u[h])&&(n[h]=p);for(;c<o;++c)d[c]=t[c];return new r.a(d,this._parents)}},function(e,t){'use strict';t.a=function(){for(var e=this._groups,t=-1,a=e.length;++t<a;)for(var n,r=e[t],o=r.length-1,i=r[o];0<=--o;)(n=r[o])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this}},function(e,t,a){'use strict';function r(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var o=a(0);t.a=function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=r);for(var a=this._groups,l=a.length,s=Array(l),d=0;d<l;++d){for(var c,p=a[d],g=p.length,n=s[d]=Array(g),u=0;u<g;++u)(c=p[u])&&(n[u]=c);n.sort(t)}return new o.a(s,this._parents).order()}},function(e,t){'use strict';t.a=function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}},function(e,t){'use strict';t.a=function(){var e=Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}},function(e,t){'use strict';t.a=function(){for(var e=this._groups,t=0,a=e.length;t<a;++t)for(var r,o=e[t],l=0,i=o.length;l<i;++l)if(r=o[l],r)return r;return null}},function(e,t){'use strict';t.a=function(){var e=0;return this.each(function(){++e}),e}},function(e,t){'use strict';t.a=function(){return!this.node()}},function(e,t){'use strict';t.a=function(e){for(var t=this._groups,a=0,r=t.length;a<r;++a)for(var o,l=t[a],s=0,i=l.length;s<i;++s)(o=l[s])&&e.call(o,o.__data__,s,l);return this}},function(e,t,a){'use strict';function n(e){return function(){this.removeAttribute(e)}}function i(e){return function(){this.removeAttributeNS(e.space,e.local)}}function r(e,t){return function(){this.setAttribute(e,t)}}function o(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function l(e,t){return function(){var a=t.apply(this,arguments);null==a?this.removeAttribute(e):this.setAttribute(e,a)}}function s(e,t){return function(){var a=t.apply(this,arguments);null==a?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}}var d=a(20);t.a=function(e,t){var a=Object(d.a)(e);if(2>arguments.length){var c=this.node();return a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}return this.each((null==t?a.local?i:n:'function'==typeof t?a.local?s:l:a.local?o:r)(a,t))}},function(e,t,a){'use strict';function n(e){return function(){this.style.removeProperty(e)}}function i(e,t,a){return function(){this.style.setProperty(e,t,a)}}function r(e,t,a){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,a)}}function o(e,t){return e.style.getPropertyValue(t)||Object(l.a)(e).getComputedStyle(e,null).getPropertyValue(t)}var l=a(22);t.a=function(e,t,a){return 1<arguments.length?this.each((null==t?n:'function'==typeof t?r:i)(e,t,null==a?'':a)):o(this.node(),e)}},function(e,t){'use strict';function a(e){return function(){delete this[e]}}function n(e,t){return function(){this[e]=t}}function i(e,t){return function(){var a=t.apply(this,arguments);null==a?delete this[e]:this[e]=a}}t.a=function(e,t){return 1<arguments.length?this.each((null==t?a:'function'==typeof t?i:n)(e,t)):this.node()[e]}},function(e,t){'use strict';function a(e){return e.trim().split(/^|\s+/)}function r(e){return e.classList||new n(e)}function n(e){this._node=e,this._names=a(e.getAttribute('class')||'')}function i(e,t){for(var a=r(e),o=-1,i=t.length;++o<i;)a.add(t[o])}function o(e,t){for(var a=r(e),o=-1,i=t.length;++o<i;)a.remove(t[o])}function l(e){return function(){i(this,e)}}function s(e){return function(){o(this,e)}}function d(e,t){return function(){(t.apply(this,arguments)?i:o)(this,e)}}n.prototype={add:function(e){var t=this._names.indexOf(e);0>t&&(this._names.push(e),this._node.setAttribute('class',this._names.join(' ')))},remove:function(e){var t=this._names.indexOf(e);0<=t&&(this._names.splice(t,1),this._node.setAttribute('class',this._names.join(' ')))},contains:function(e){return 0<=this._names.indexOf(e)}},t.a=function(e,t){var o=a(e+'');if(2>arguments.length){for(var c=r(this.node()),p=-1,i=o.length;++p<i;)if(!c.contains(o[p]))return!1;return!0}return this.each(('function'==typeof t?d:t?l:s)(o,t))}},function(e,t){'use strict';function a(){this.textContent=''}function n(e){return function(){this.textContent=e}}function i(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?'':t}}t.a=function(e){return arguments.length?this.each(null==e?a:('function'==typeof e?i:n)(e)):this.node().textContent}},function(e,t){'use strict';function a(){this.innerHTML=''}function n(e){return function(){this.innerHTML=e}}function i(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?'':t}}t.a=function(e){return arguments.length?this.each(null==e?a:('function'==typeof e?i:n)(e)):this.node().innerHTML}},function(e,t){'use strict';function a(){this.nextSibling&&this.parentNode.appendChild(this)}t.a=function(){return this.each(a)}},function(e,t){'use strict';function a(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}t.a=function(){return this.each(a)}},function(e,t,a){'use strict';var n=a(23);t.a=function(e){var t='function'==typeof e?e:Object(n.a)(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}},function(e,t,a){'use strict';function n(){return null}var i=a(23),r=a(17);t.a=function(e,t){var a='function'==typeof e?e:Object(i.a)(e),o=null==t?n:'function'==typeof t?t:Object(r.a)(t);return this.select(function(){return this.insertBefore(a.apply(this,arguments),o.apply(this,arguments)||null)})}},function(e,t){'use strict';function a(){var e=this.parentNode;e&&e.removeChild(this)}t.a=function(){return this.each(a)}},function(e,t){'use strict';t.a=function(e){return arguments.length?this.property('__data__',e):this.node().__data__}},function(e,t){'use strict';function a(e,t,a){return e=n(e,t,a),function(t){var a=t.relatedTarget;a&&(a===this||8&a.compareDocumentPosition(this))||e.call(this,t)}}function n(e,t,a){return function(n){var i=s;s=n;try{e.call(this,this.__data__,t,a)}finally{s=i}}}function r(e){return e.trim().split(/^|\s+/).map(function(e){var a='',n=e.indexOf('.');return 0<=n&&(a=e.slice(n+1),e=e.slice(0,n)),{type:e,name:a}})}function o(e){return function(){var t=this.__on;if(t){for(var a,n=0,r=-1,i=t.length;n<i;++n)(a=t[n],(!e.type||a.type===e.type)&&a.name===e.name)?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function l(e,t,r){var l=i.hasOwnProperty(e.type)?a:n;return function(a,n,i){var s,o=this.__on,d=l(t,n,i);if(o)for(var c=0,p=o.length;c<p;++c)if((s=o[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=d,s.capture=r),void(s.value=t);this.addEventListener(e.type,d,r),s={type:e.type,name:e.name,value:t,listener:d,capture:r},o?o.push(s):this.__on=[s]}}var i={},s=null;if('undefined'!=typeof document){var d=document.documentElement;'onmouseenter'in d||(i={mouseenter:'mouseover',mouseleave:'mouseout'})}t.a=function(e,a,s){var d,i,t=r(e+''),c=t.length;if(2>arguments.length){var n=this.node().__on;if(n)for(var p,g=0,u=n.length;g<u;++g)for(d=0,p=n[g];d<c;++d)if((i=t[d]).type===p.type&&i.name===p.name)return p.value;return}for(n=a?l:o,null==s&&(s=!1),d=0;d<c;++d)this.each(n(t[d],a,s));return this}},function(e,t,a){'use strict';function n(e,t,a){var n=Object(o.a)(e),i=n.CustomEvent;'function'==typeof i?i=new i(t,a):(i=n.document.createEvent('Event'),a?(i.initEvent(t,a.bubbles,a.cancelable),i.detail=a.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function i(e,t){return function(){return n(this,e,t)}}function r(e,t){return function(){return n(this,e,t.apply(this,arguments))}}var o=a(22);t.a=function(e,t){return this.each(('function'==typeof t?r:i)(e,t))}},function(e,t,a){'use strict';function n(e){var t=e.domain;return e.ticks=function(e){var a=t();return Object(l.d)(a[0],a[a.length-1],null==e?10:e)},e.tickFormat=function(e,a){return Object(c.a)(t(),e,a)},e.nice=function(a){null==a&&(a=10);var n,i=t(),s=0,d=i.length-1,c=i[s],p=i[d];return p<c&&(n=c,c=p,p=n,n=s,s=d,d=n),n=Object(l.b)(c,p,a),0<n?(c=o(c/n)*n,p=r(p/n)*n,n=Object(l.b)(c,p,a)):0>n&&(c=r(c*n)/n,p=o(p*n)/n,n=Object(l.b)(c,p,a)),0<n?(i[s]=o(c/n)*n,i[d]=r(p/n)*n,t(i)):0>n&&(i[s]=r(c*n)/n,i[d]=o(p*n)/n,t(i)),e},e}function i(){var e=Object(d.b)(d.c,s.b);return e.copy=function(){return Object(d.a)(e,i())},n(e)}var r=Math.ceil,o=Math.floor;t.a=i;var l=a(8),s=a(35),d=a(118),c=a(122)},function(e,t,a){'use strict';var n=a(26)},function(){'use strict'},function(e,t,a){'use strict';var n=a(29),i=a(24),r=a(93),o=a(9),l=a(94),s=a(30),d=a(31),c=a(32)},function(e,t){'use strict';t.a=function(e){return function(){return e}}},function(e,t){'use strict';t.a=function(e){return e}},function(e,t,a){'use strict';var n=a(29),i=a(1),r=a(3),o=a(10)},function(e,t,a){'use strict';var n=a(27)},function(){'use strict'},function(e,t,a){'use strict';var n=a(3)},function(e,t,a){'use strict';var n=a(1),i=a(3),r=a(10)},function(){'use strict'},function(){'use strict'},function(e,t,a){'use strict';var n=a(1)},function(){'use strict'},function(){'use strict'},function(e,t,a){'use strict';var n=a(34)},function(e,t,a){'use strict';function n(e){if(e instanceof r)return new r(e.l,e.a,e.b,e.opacity);if(e instanceof g){var t=e.h*y.a;return new r(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof f.b||(e=Object(f.h)(e));var n=d(e.r),i=d(e.g),a=d(e.b),o=s((0.4124564*n+0.3575761*i+0.1804375*a)/v),l=s((0.2126729*n+0.7151522*i+0.072175*a)/_),c=s((0.0193339*n+0.119192*i+0.9503041*a)/S);return new r(116*l-16,500*(o-l),200*(l-c),e.opacity)}function i(e,t,a,i){return 1===arguments.length?n(e):new r(e,t,a,null==i?1:i)}function r(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function s(e){return e>x?u(e,1/3):e/k+b}function o(e){return e>w?e*e*e:k*(e-b)}function l(e){return 255*(0.0031308>=e?12.92*e:1.055*u(e,1/2.4)-0.055)}function d(e){return 0.04045>=(e/=255)?e/12.92:u((e+0.055)/1.055,2.4)}function p(e){if(e instanceof g)return new g(e.h,e.c,e.l,e.opacity);e instanceof r||(e=n(e));var t=Math.atan2(e.b,e.a)*y.b;return new g(0>t?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function c(e,t,a,n){return 1===arguments.length?p(e):new g(e,t,a,null==n?1:n)}function g(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}var u=Math.pow;t.a=i,t.b=c;var m=a(13),f=a(12),y=a(36),h=18,v=0.95047,_=1,S=1.08883,b=4/29,w=6/29,k=3*w*w,x=w*w*w;Object(m.a)(r,i,Object(m.b)(f.a,{brighter:function(e){return new r(this.l+h*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new r(this.l-h*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return e=_*o(e),t=v*o(t),a=S*o(a),new f.b(l(3.2404542*t-1.5371385*e-0.4985314*a),l(-0.969266*t+1.8760108*e+0.041556*a),l(0.0556434*t-0.2040259*e+1.0572252*a),this.opacity)}})),Object(m.a)(g,c,Object(m.b)(f.a,{brighter:function(e){return new g(this.h,this.c,this.l+h*(null==e?1:e),this.opacity)},darker:function(e){return new g(this.h,this.c,this.l-h*(null==e?1:e),this.opacity)},rgb:function(){return n(this).rgb()}}))},function(e,t,a){'use strict';function n(e){if(e instanceof d)return new d(e.h,e.s,e.l,e.opacity);e instanceof c.b||(e=Object(c.h)(e));var t=e.r/255,a=e.g/255,n=e.b/255,i=(_*n+f*t-v*a)/(_+f-v),r=n-i,o=(y*(a-i)-u*r)/m,l=Math.sqrt(o*o+r*r)/(y*i*(1-i)),s=l?Math.atan2(o,r)*p.b-120:NaN;return new d(0>s?s+360:s,l,i,e.opacity)}function i(e,t,a,i){return 1===arguments.length?n(e):new d(e,t,a,null==i?1:i)}function d(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}var r=Math.pow;t.a=i;var o=a(13),c=a(12),p=a(36),s=-0.14861,g=+1.78277,u=-0.29227,m=-0.90649,y=+1.97294,f=y*m,v=y*g,_=g*u-m*s;Object(o.a)(d,i,Object(o.b)(c.a,{brighter:function(e){return e=null==e?c.c:r(c.c,e),new d(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?c.d:r(c.d,e),new d(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*p.a,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Math.cos(e),i=Math.sin(e);return new c.b(255*(t+n*(s*a+g*i)),255*(t+n*(u*a+m*i)),255*(t+n*(y*a)),this.opacity)}}))},function(e,t){'use strict';t.a=function(e,n){return e=+e,n-=e,function(a){return Math.round(e+n*a)}}},function(e,t,a){'use strict';function n(e,t,a,n){function o(e){return e.length?e.pop()+' ':''}function i(e,n,o,l,d,s){if(e!==o||n!==l){var c=d.push('translate(',null,t,null,a);s.push({i:c-4,x:Object(r.a)(e,o)},{i:c-2,x:Object(r.a)(n,l)})}else(o||l)&&d.push('translate('+o+t+l+a)}function l(e,t,a,i){e===t?t&&a.push(o(a)+'rotate('+t+n):(180<e-t?t+=360:180<t-e&&(e+=360),i.push({i:a.push(o(a)+'rotate(',null,n)-2,x:Object(r.a)(e,t)}))}function d(e,t,a,i){e===t?t&&a.push(o(a)+'skewX('+t+n):i.push({i:a.push(o(a)+'skewX(',null,n)-2,x:Object(r.a)(e,t)})}function c(e,t,a,n,l,s){if(e!==a||t!==n){var d=l.push(o(l)+'scale(',null,',',null,')');s.push({i:d-4,x:Object(r.a)(e,a)},{i:d-2,x:Object(r.a)(t,n)})}else(1!==a||1!==n)&&l.push(o(l)+'scale('+a+','+n+')')}return function(t,a){var r=[],s=[];return t=e(t),a=e(a),i(t.translateX,t.translateY,a.translateX,a.translateY,r,s),l(t.rotate,a.rotate,r,s),d(t.skewX,a.skewX,r,s),c(t.scaleX,t.scaleY,a.scaleX,a.scaleY,r,s),t=a=null,function(e){for(var t,a=-1,i=s.length;++a<i;)r[(t=s[a]).i]=t.x(e);return r.join('')}}}var r=a(5),i=a(110),o=n(i.a,'px, ','px)','deg)'),l=n(i.b,', ',')',')')},function(e,t,a){'use strict';t.a=function(e){return'none'===e?l.b:(n||(n=document.createElement('DIV'),i=document.documentElement,r=document.defaultView),n.style.transform=e,e=r.getComputedStyle(i.appendChild(n),null).getPropertyValue('transform'),i.removeChild(n),e=e.slice(7,-1).split(','),Object(l.a)(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},t.b=function(e){return null==e?l.b:(o||(o=document.createElementNS('http://www.w3.org/2000/svg','g')),o.setAttribute('transform',e),!(e=o.transform.baseVal.consolidate()))?l.b:(e=e.matrix,Object(l.a)(e.a,e.b,e.c,e.d,e.e,e.f))};var n,i,r,o,l=a(111)},function(e,t,a){'use strict';var n=Math.sqrt;a.d(t,'b',function(){return r});var i=180/Math.PI,r={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};t.a=function(t,r,o,l,s,d){var c,p,g;return(c=n(t*t+r*r))&&(t/=c,r/=c),(g=t*o+r*l)&&(o-=t*g,l-=r*g),(p=n(o*o+l*l))&&(o/=p,l/=p,g/=p),t*l<r*o&&(t=-t,r=-r,g=-g,c=-c),{translateX:s,translateY:d,rotate:Math.atan2(r,t)*i,skewX:Math.atan(g)*i,scaleX:c,scaleY:p}}},function(){'use strict';function e(e){return((e=n(e))+1/e)/2}function t(e){return((e=n(e))-1/e)/2}function a(e){return((e=n(2*e))-1)/(e+1)}var n=Math.exp,i=Math.log,r=Math.sqrt,o=Math.SQRT2,l=2,s=4},function(e,t,a){'use strict';function n(e){return function(a,t){var n=e((a=Object(i.d)(a)).h,(t=Object(i.d)(t)).h),o=Object(r.a)(a.s,t.s),s=Object(r.a)(a.l,t.l),l=Object(r.a)(a.opacity,t.opacity);return function(e){return a.h=n(e),a.s=o(e),a.l=s(e),a.opacity=l(e),a+''}}}var i=a(2),r=a(4),o=n(r.c),l=n(r.a)},function(e,t,a){'use strict';var n=a(2),i=a(4)},function(e,t,a){'use strict';function n(e){return function(a,t){var n=e((a=Object(i.c)(a)).h,(t=Object(i.c)(t)).h),o=Object(r.a)(a.c,t.c),s=Object(r.a)(a.l,t.l),l=Object(r.a)(a.opacity,t.opacity);return function(e){return a.h=n(e),a.c=o(e),a.l=s(e),a.opacity=l(e),a+''}}}var i=a(2),r=a(4),o=n(r.c),l=n(r.a)},function(e,t,a){'use strict';function n(e){return function t(a){function n(n,t){var o=e((n=Object(i.b)(n)).h,(t=Object(i.b)(t)).h),d=Object(r.a)(n.s,t.s),s=Object(r.a)(n.l,t.l),l=Object(r.a)(n.opacity,t.opacity);return function(e){return n.h=o(e),n.s=d(e),n.l=s(Math.pow(e,a)),n.opacity=l(e),n+''}}return a=+a,n.gamma=t,n}(1)}var i=a(2),r=a(4),o=n(r.c),l=n(r.a)},function(){'use strict'},function(e,t,a){'use strict';function n(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:Object(g.a)(t)}function i(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:i(e)}}}function r(e){return function(n,i){var o=e(n=+n,i=+i);return function(e){return 0>=e?n:1<=e?i:o(e)}}}function o(e,t,a,n){var i=e[0],r=e[1],o=t[0],l=t[1];return r<i?(i=a(r,i),o=n(l,o)):(i=a(i,r),o=n(o,l)),function(e){return o(i(e))}}function l(e,t,a,n){var o=s(e.length,t.length)-1,l=Array(o),d=Array(o),r=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<o;)l[r]=a(e[r],e[r+1]),d[r]=n(t[r],t[r+1]);return function(t){var a=Object(c.a)(e,t,1,o)-1;return d[a](l[a](t))}}var s=Math.min;t.c=n,t.a=function(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())},t.b=function(e,t){function a(){return g=2<s(v.length,b.length)?l:o,h=f=null,c}function c(t){return(h||(h=g(v,b,S?i(e):e,y)))(+t)}var g,h,f,v=m,b=m,y=d.a,S=!1;return c.invert=function(e){return(f||(f=g(b,v,n,S?r(t):t)))(+e)},c.domain=function(e){return arguments.length?(v=p.a.call(e,u.a),a()):v.slice()},c.range=function(e){return arguments.length?(b=p.b.call(e),a()):b.slice()},c.rangeRound=function(e){return b=p.b.call(e),y=d.c,a()},c.clamp=function(e){return arguments.length?(S=!!e,a()):S},c.interpolate=function(e){return arguments.length?(y=e,a()):y},a()};var c=a(8),d=a(35),p=a(119),g=a(120),u=a(121),m=[0,1]},function(e,t,a){'use strict';a.d(t,'a',function(){return i}),a.d(t,'b',function(){return r});var n=Array.prototype,i=n.map,r=n.slice},function(e,t){'use strict';t.a=function(e){return function(){return e}}},function(e,t){'use strict';t.a=function(e){return+e}},function(e,t,a){'use strict';var n=Math.max,i=Math.abs,r=a(8),o=a(123);t.a=function(e,t,a){var l,s=e[0],d=e[e.length-1],c=Object(r.c)(s,d,null==t?10:t);switch(a=Object(o.c)(null==a?',f':a),a.type){case's':{var p=n(i(s),i(d));return null!=a.precision||isNaN(l=Object(o.e)(c,p))||(a.precision=l),Object(o.b)(a,p)}case'':case'e':case'g':case'p':case'r':{null!=a.precision||isNaN(l=Object(o.f)(c,n(i(s),i(d))))||(a.precision=l-('e'===a.type));break}case'f':case'%':{null!=a.precision||isNaN(l=Object(o.d)(c))||(a.precision=l-2*('%'===a.type));break}}return Object(o.a)(a)}},function(e,t,a){'use strict';var n=a(124);a.d(t,'a',function(){return n.a}),a.d(t,'b',function(){return n.b});var i=a(44),r=a(45);a.d(t,'c',function(){return r.a});var o=a(130);a.d(t,'d',function(){return o.a});var l=a(131);a.d(t,'e',function(){return l.a});var s=a(132);a.d(t,'f',function(){return s.a})},function(e,t,a){'use strict';a.d(t,'a',function(){return i}),a.d(t,'b',function(){return r});var n,i,r,o=a(44);(function(e){return n=Object(o.a)(e),i=n.format,r=n.formatPrefix,n})({decimal:'.',thousands:',',grouping:[3],currency:['$','']})},function(e,t){'use strict';t.a=function(e,a){return function(n,r){for(var o=n.length,i=[],t=0,l=e[0],s=0;0<o&&0<l&&(s+l+1>r&&(l=Math.max(1,r-s)),i.push(n.substring(o-=l,o+l)),!((s+=l+1)>r));)l=e[t=(t+1)%e.length];return i.reverse().join(a)}}},function(e,t){'use strict';t.a=function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}},function(e,t){'use strict';t.a=function(e,t){e=e.toPrecision(t);out:for(var a,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case'.':i=a=n;break;case'0':0===i&&(i=n),a=n;break;case'e':break out;default:0<i&&(i=0);}return 0<i?e.slice(0,i)+e.slice(a+1):e}},function(e,t,a){'use strict';var n=a(15);t.a=function(e,t){var a=Object(n.a)(e,t);if(!a)return e+'';var i=a[0],r=a[1];return 0>r?'0.'+Array(-r).join('0')+i:i.length>r+1?i.slice(0,r+1)+'.'+i.slice(r+1):i+Array(r-i.length+2).join('0')}},function(e,t){'use strict';t.a=function(e){return e}},function(e,t,a){'use strict';var n=a(6);t.a=function(e){return Math.max(0,-Object(n.a)(Math.abs(e)))}},function(e,t,a){'use strict';var n=Math.max,i=a(6);t.a=function(e,t){return n(0,3*n(-8,Math.min(8,Math.floor(Object(i.a)(t)/3)))-Object(i.a)(Math.abs(e)))}},function(e,t,a){'use strict';var n=Math.abs,i=a(6);t.a=function(e,t){return e=n(e),t=n(t)-e,Math.max(0,Object(i.a)(t)-Object(i.a)(e))+1}},function(e,t){'use strict';function a(e,t,a){return 1/Math.sqrt(2*h)*m(-(u(e-t,2)/(2*u(a,2))))}function n(e,t,a){return 1<y((e-t)/a)?0:3/4*(1-u((e-t)/a,2))}function r(e,t,a){return 1/(m((e-t)/a)+m(-(e-t)/a))}function o(e,t,a){return 1<y((e-t)/a)?0:1/2}function l(e,t,a){return 1<y((e-t)/a)?0:1-y((e-t)/a)}function s(e,t,a){return 1<y((e-t)/a)?0:15/16*u(1-u((e-t)/a,2),2)}function d(e,t,a){return 1<y((e-t)/a)?0:35/32*u(1-u((e-t)/a,2),3)}function c(e,t,a){return 1<y((e-t)/a)?0:h/4*Math.cos(h/2*((e-t)/a))}function p(e,t,a){return 1<y((e-t)/a)?0:70/81*u(1-u(y((e-t)/a),3),3)}function g(e,t,a){var n=y((t-e)/a);return 0.5*m(-n/i)*Math.sin(n/i+h/4)}var i=Math.SQRT2,m=Math.exp,h=Math.PI,y=Math.abs,u=Math.pow;const f={};t.a=f,f.smooth={},f.smooth.kernel2=function(){function e(){var e=[];e=f.map(function(e){return[b(e),_(e)]});var a=[];if('number'==typeof y)for(t=0;t<e.length;t++)a.push(y);else if(!('object'==typeof y&&Array.isArray(y)))throw console.log(y),new Error('Invalid scale parameter');else if(y.length===e.length)a=y.slice();else{var n=0;for(t=0;t<e.length;t++)a.push(y[n]),t<y.length?n++:n=0}for(t=0;t<e.length;t++){var r=0,o=0,l=0,s=m[v](e[t][0],e[t][0],a[t]);for(r+=s*e[t][1],o+=s,i=t-1;-1<i&&(l=m[v](e[t][0],e[i][0],a[t]),!(l/s<h));i--)r+=l*e[i][1],o+=l;for(i=t+1;i<e.length&&(l=m[v](e[t][0],e[i][0],a[t]),!(l/s<h));i++)r+=l*e[i][1],o+=l;u.push([e[t][0],r/o])}}var t,i,u=[],m={Uniform:o,Triangle:l,Epanechnikov:n,Quartic:s,Triweight:d,Logistic:r,Cosine:c,Gaussian:a,Tricube:p,Silverman:g},h=1e-3,y=[],f=[],v='Gaussian',b=function(e){return e[0]},_=function(e){return e[1]};return e.scale=function(t){return arguments.length?(y=t,e):y},e.kernel=function(t){if(!arguments.length)return v;if('function'!=typeof m[t])throw new Error('Invalid kernel');return v=t,e},e.x=function(t){return arguments.length?(b=t,e):b},e.y=function(t){return arguments.length?(_=t,e):_},e.output=function(){return u},e.diff=function(t){return arguments.length?(h=t,e):h},e.data=function(t){return f=t,e},e}},function(e,t,a){var n;(function(i){'use strict';function r(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function o(e,t){return e<<t|e>>>32-t}function l(e,n,a,i,l,s){return r(o(r(r(n,e),r(i,s)),l),a)}function s(e,a,n,i,r,o,s){return l(a&n|~a&i,e,a,r,o,s)}function p(e,a,n,i,r,o,s){return l(a&i|n&~i,e,a,r,o,s)}function g(e,a,n,i,r,o,s){return l(a^n^i,e,a,r,o,s)}function u(e,a,n,i,r,o,s){return l(n^(a|~i),e,a,r,o,s)}function d(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var n,i,o,l,m,h=1732584193,a=-271733879,y=-1732584194,c=271733878;for(n=0;n<e.length;n+=16)i=h,o=a,l=y,m=c,h=s(h,a,y,c,e[n],7,-680876936),c=s(c,h,a,y,e[n+1],12,-389564586),y=s(y,c,h,a,e[n+2],17,606105819),a=s(a,y,c,h,e[n+3],22,-1044525330),h=s(h,a,y,c,e[n+4],7,-176418897),c=s(c,h,a,y,e[n+5],12,1200080426),y=s(y,c,h,a,e[n+6],17,-1473231341),a=s(a,y,c,h,e[n+7],22,-45705983),h=s(h,a,y,c,e[n+8],7,1770035416),c=s(c,h,a,y,e[n+9],12,-1958414417),y=s(y,c,h,a,e[n+10],17,-42063),a=s(a,y,c,h,e[n+11],22,-1990404162),h=s(h,a,y,c,e[n+12],7,1804603682),c=s(c,h,a,y,e[n+13],12,-40341101),y=s(y,c,h,a,e[n+14],17,-1502002290),a=s(a,y,c,h,e[n+15],22,1236535329),h=p(h,a,y,c,e[n+1],5,-165796510),c=p(c,h,a,y,e[n+6],9,-1069501632),y=p(y,c,h,a,e[n+11],14,643717713),a=p(a,y,c,h,e[n],20,-373897302),h=p(h,a,y,c,e[n+5],5,-701558691),c=p(c,h,a,y,e[n+10],9,38016083),y=p(y,c,h,a,e[n+15],14,-660478335),a=p(a,y,c,h,e[n+4],20,-405537848),h=p(h,a,y,c,e[n+9],5,568446438),c=p(c,h,a,y,e[n+14],9,-1019803690),y=p(y,c,h,a,e[n+3],14,-187363961),a=p(a,y,c,h,e[n+8],20,1163531501),h=p(h,a,y,c,e[n+13],5,-1444681467),c=p(c,h,a,y,e[n+2],9,-51403784),y=p(y,c,h,a,e[n+7],14,1735328473),a=p(a,y,c,h,e[n+12],20,-1926607734),h=g(h,a,y,c,e[n+5],4,-378558),c=g(c,h,a,y,e[n+8],11,-2022574463),y=g(y,c,h,a,e[n+11],16,1839030562),a=g(a,y,c,h,e[n+14],23,-35309556),h=g(h,a,y,c,e[n+1],4,-1530992060),c=g(c,h,a,y,e[n+4],11,1272893353),y=g(y,c,h,a,e[n+7],16,-155497632),a=g(a,y,c,h,e[n+10],23,-1094730640),h=g(h,a,y,c,e[n+13],4,681279174),c=g(c,h,a,y,e[n],11,-358537222),y=g(y,c,h,a,e[n+3],16,-722521979),a=g(a,y,c,h,e[n+6],23,76029189),h=g(h,a,y,c,e[n+9],4,-640364487),c=g(c,h,a,y,e[n+12],11,-421815835),y=g(y,c,h,a,e[n+15],16,530742520),a=g(a,y,c,h,e[n+2],23,-995338651),h=u(h,a,y,c,e[n],6,-198630844),c=u(c,h,a,y,e[n+7],10,1126891415),y=u(y,c,h,a,e[n+14],15,-1416354905),a=u(a,y,c,h,e[n+5],21,-57434055),h=u(h,a,y,c,e[n+12],6,1700485571),c=u(c,h,a,y,e[n+3],10,-1894986606),y=u(y,c,h,a,e[n+10],15,-1051523),a=u(a,y,c,h,e[n+1],21,-2054922799),h=u(h,a,y,c,e[n+8],6,1873313359),c=u(c,h,a,y,e[n+15],10,-30611744),y=u(y,c,h,a,e[n+6],15,-1560198380),a=u(a,y,c,h,e[n+13],21,1309151649),h=u(h,a,y,c,e[n+4],6,-145523070),c=u(c,h,a,y,e[n+11],10,-1120210379),y=u(y,c,h,a,e[n+2],15,718787259),a=u(a,y,c,h,e[n+9],21,-343485551),h=r(h,i),a=r(a,o),y=r(y,l),c=r(c,m);return[h,a,y,c]}function c(e){var t,a='',n=32*e.length;for(t=0;t<n;t+=8)a+=String.fromCharCode(255&e[t>>5]>>>t%32);return a}function m(e){var t,a=[];for(a[(e.length>>2)-1]=void 0,t=0;t<a.length;t+=1)a[t]=0;var n=8*e.length;for(t=0;t<n;t+=8)a[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return a}function h(e){return c(d(m(e),8*e.length))}function y(e,t){var a,n,i=m(e),r=[],o=[];for(r[15]=o[15]=void 0,16<i.length&&(i=d(i,8*e.length)),a=0;16>a;a+=1)r[a]=909522486^i[a],o[a]=1549556828^i[a];return n=d(r.concat(m(t)),512+8*t.length),c(d(o.concat(n),640))}function f(e){var t,a,n='0123456789abcdef',i='';for(a=0;a<e.length;a+=1)t=e.charCodeAt(a),i+=n.charAt(15&t>>>4)+n.charAt(15&t);return i}function v(e){return unescape(encodeURIComponent(e))}function b(e){return h(v(e))}function _(e){return f(b(e))}function S(e,t){return y(v(e),v(t))}function w(e,t){return f(S(e,t))}function k(e,t,a){return t?a?S(t,e):w(t,e):a?b(e):_(e)}n=function(){return k}.call(t,a,t,e),!(n!==void 0&&(e.exports=n))})(this)},function(e,t){'use strict';let a=['getInt16',2,!0],n=['getUint16',2,!0],i=['getUint32',4,!0],r=[[0,[[a,'instantaneous_power']]],[1,[[['getUint8',1],'pedal_power_balance']]],[2,[]],[4,[[n,'accumulated_torque']]],[8,[]],[16,[[i,'cumulative_wheel_revolutions'],[n,'last_wheel_event_time']]],[32,[[n,'cumulative_crank_revolutions'],[n,'last_crank_event_time']]],[64,[[a,'maximum_force_magnitude'],[a,'minimum_force_magnitude']]],[128,[[a,'maximum_torque_magnitude'],[a,'minimum_torque_magnitude']]],[256,[[['getUint8',3],'maximum_minimum_angle']]],[512,[[n,'top_dead_spot_angle']]],[1024,[[n,'bottom_dead_spot_angle']]],[2048,[[n,'accumulated_energy']]],[4096,[]]],o=[[1,[[i,'cumulative_wheel_revolutions'],[n,'last_wheel_event_time']]],[2,[[n,'cumulative_crank_revolutions'],[n,'last_crank_event_time']]]];class l{getData(e){let t,a=0;16===this.mask_size?(t=e.getUint16(0,!0),a+=2):(t=e.getUint8(0),a+=1);let n=[];if(0===this.fields[0][0])for(let e of this.fields[0][1])n.push(e);for(let[a,i]of this.fields)if(t&a)for(let e of i)n.push(e);let i={};for(let t of n){var[[o,l,s],r]=t;let n;n=s?e[o](a,s):e[o](a),i[r]=n,a+=l}return i}}class s extends l{constructor(){super(),this.fields=o,this.mask_size=8}}class d extends l{constructor(){super(),this.fields=r,this.mask_size=16}}t.e=d;class c{constructor(e,t,a,n){this.device=e,this.server=t,this.service=a,this.characteristic=n,this.name=this.device.name,this.id=this.device.id,this.listening=!1,this.listeners={},this.device.addEventListener('gattserverdisconnected',(t)=>{this.gattserverdisconnected(t).catch((e)=>{console.log('Error: ',e)})})}async gattserverdisconnected(){console.log('Reconnecting'),this.server=await this.device.gatt.connect(),this.service=await this.server.getPrimaryService(this.serviceId),this.characteristic=await this.service.getCharacteristic(this.characteristicId),this.listening&&(this.listening=!1,this.listen())}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}dispatch(e,t){e in this.listeners||(this.listeners[e]=[]);for(let a of this.listeners[e])a(t)}}t.c=class extends c{constructor(e,t,a,n){super(e,t,a,n),this.serviceId=6168,this.characteristicId=10851,this.parser=new d,this.lastCrankRevolutions=0,this.lastCrankTime=0}listen(){this.listening||(this.characteristic.addEventListener('characteristicvaluechanged',(e)=>{let t=this.parser.getData(e.target.value),a=t.instantaneous_power,n=t.cumulative_crank_revolutions,i=t.last_crank_event_time;this.lastCrankTime>i&&(this.lastCrankTime-=65536),this.lastCrankRevolutions>n&&(this.lastCrankRevolutions-=65536);let r=n-this.lastCrankRevolutions,o=(i-this.lastCrankTime)/1024,l=0;0<o&&(l=60*(r/o)),this.lastCrankRevolutions=n,this.lastCrankTime=i,this.dispatch('power',a),this.dispatch('cadence',l)}),this.characteristic.startNotifications(),this.listening=!0)}};t.d=class extends c{constructor(e,t,a,n){super(e,t,a,n),this.serviceId=6168,this.characteristicId=10851,this.parser=new d}listen(){this.listening||(this.characteristic.addEventListener('characteristicvaluechanged',(e)=>{let t=this.parser.getData(e.target.value),a=t.instantaneous_power;this.dispatch('power',a)}),this.characteristic.startNotifications(),this.listening=!0)}};t.a=class extends c{constructor(e,t,a,n){super(e,t,a,n),this.serviceId=6166,this.characteristicId=10843,this.parser=new s,this.lastCrankRevolutions=0,this.lastCrankTime=0}listen(){this.listening||(this.characteristic.addEventListener('characteristicvaluechanged',(e)=>{let t=this.parser.getData(e.target.value),a=t.cumulative_crank_revolutions,n=t.last_crank_event_time;if(a!==void 0&&n!==void 0){this.lastCrankTime>n&&(this.lastCrankTime-=65536),this.lastCrankRevolutions>a&&(this.lastCrankRevolutions-=65536);let e=a-this.lastCrankRevolutions,t=(n-this.lastCrankTime)/1024,i=0;0<t&&(i=60*(e/t)),this.lastCrankRevolutions=a,this.lastCrankTime=n,this.dispatch('cadence',i)}}),this.characteristic.startNotifications(),this.listening=!0)}};t.b=class extends c{constructor(e,t,a,n){super(e,t,a,n),this.serviceId=6157,this.characteristicId=10807}listen(){this.listening||(this.characteristic.addEventListener('characteristicvaluechanged',(e)=>{let t=e.target.value.getUint8(1);this.dispatch('hr',t)}),this.characteristic.startNotifications(),this.listening=!0)}};t.f=class{constructor(){this.listeners={},this.listening=!1,this.watts=0,this.id='virtual',this.name='Virtual Power Meter'}listen(){if(!this.listening){document.getElementById('ui-vpower-container').style.display='block';let e=document.getElementById('vpower');e.value=this.watts,e.onchange=()=>{this.watts=parseInt(e.value)},setInterval(()=>{this.dispatch('power',this.watts)},750),this.listening=!0}}addListener(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}dispatch(e,t){e in this.listeners||(this.listeners[e]=[]);for(let a of this.listeners[e])a(t)}}},function(e,t,a){'use strict';(function(t){function a(e){var t,a,o,s,d,i,c=Object.create(null);if(this[g]=c,!!e)if('string'==typeof e)for('?'===e.charAt(0)&&(e=e.slice(1)),s=e.split('&'),d=0,i=s.length;d<i;d++)o=s[d],t=o.indexOf('='),-1<t?n(c,r(o.slice(0,t)),r(o.slice(t+1))):o.length&&n(c,r(o),'');else if(l(e))for(d=0,i=e.length;d<i;d++)o=e[d],n(c,o[0],o[1]);else for(a in e)n(c,a,e[a])}function n(e,t,a){t in e?e[t].push(''+a):e[t]=l(a)?a:[''+a]}function r(e){return decodeURIComponent(e.replace(d,' '))}function o(e){return encodeURIComponent(e).replace(s,p)}var l=Array.isArray,i=a.prototype,s=/[!'\(\)~]|%20|%00/g,d=/\+/g,c={"!":'%21',"'":'%27',"(":'%28',")":'%29',"~":'%7E',"%20":'+',"%00":'\0'},p=function(e){return c[e]},g='__URLSearchParams__:'+Math.random();i.append=function(e,t){n(this[g],e,t)},i.delete=function(e){delete this[g][e]},i.get=function(e){var t=this[g];return e in t?t[e][0]:null},i.getAll=function(e){var t=this[g];return e in t?t[e].slice(0):[]},i.has=function(e){return e in this[g]},i.set=function(e,t){this[g][e]=[''+t]},i.forEach=function(e,t){var a=this[g];Object.getOwnPropertyNames(a).forEach(function(n){a[n].forEach(function(a){e.call(t,a,n,this)},this)},this)},i.toJSON=function(){return{}},i.toString=function(){var e,t,a,n,i=this[g],r=[];for(t in i)for(a=o(t),e=0,n=i[t];e<n.length;e++)r.push(a+'='+o(n[e]));return r.join('&')},a=e.exports=t.URLSearchParams||a,function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}();'forEach'in e||(e.forEach=function(e,t){var a=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,'=').split('=').forEach(function(n){!n.length||n in a||(a[n]=this.getAll(n)).forEach(function(a){e.call(t,a,n,this)},this)},this)}),'keys'in e||(e.keys=function(){var e=[];this.forEach(function(t,a){e.push(a)});var a={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(a[Symbol.iterator]=function(){return a}),a}),'values'in e||(e.values=function(){var e=[];this.forEach(function(t){e.push(t)});var a={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(a[Symbol.iterator]=function(){return a}),a}),'entries'in e||(e.entries=function(){var e=[];this.forEach(function(t,a){e.push([a,t])});var a={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(a[Symbol.iterator]=function(){return a}),a}),t&&!(Symbol.iterator in e)&&(e[Symbol.iterator]=e.entries),'sort'in e||(e.sort=function(){for(var e,t,a,n=this.entries(),i=n.next(),r=i.done,o=[],l=Object.create(null);!r;)a=i.value,t=a[0],o.push(t),t in l||(l[t]=[]),l[t].push(a[1]),i=n.next(),r=i.done;for(o.sort(),e=0;e<o.length;e++)this.delete(o[e]);for(e=0;e<o.length;e++)t=o[e],this.append(t,l[t].shift())})}(a.prototype)}).call(t,a(137))},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(a){'object'==typeof window&&(t=window)}e.exports=t}]);
//# sourceMappingURL=bundle.js.map